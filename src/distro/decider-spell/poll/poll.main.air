(xor
 (seq
  (seq
   (seq
    (seq
     (seq
      (call %init_peer_id% ("getDataSrv" "-relay-") [] -relay-)
      (call %init_peer_id% ("getDataSrv" "spell_id") [] -spell_id-arg-)
     )
     (call %init_peer_id% ("getDataSrv" "chain") [] -chain-arg-)
    )
    (new $latest
     (seq
      (seq
       (seq
        (call %init_peer_id% ("chain_connector" "latest_block_number") [-chain-arg-.$.api_endpoint] ret)
        (new -if-else-error-
         (new -else-error-
          (new -if-error-
           (xor
            (match ret.$.success true
             (ap ret.$.number_hex $latest)
            )
            (seq
             (ap :error: -if-error-)
             (xor
              (match :error:.$.error_code 10001
               (seq
                (seq
                 (seq
                  (new $array-inline
                   (seq
                    (seq
                     (ap "error retrieving latest block number" $array-inline)
                     (ap ret.$.error $array-inline)
                    )
                    (canon %init_peer_id% $array-inline  #array-inline-0)
                   )
                  )
                  (par
                   (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-0])
                   (null)
                  )
                 )
                 (call %init_peer_id% ("json" "stringify") [#array-inline-0] ret-0)
                )
                (call %init_peer_id% (-spell_id-arg- "store_log") [ret-0] ret-1)
               )
              )
              (seq
               (seq
                (ap :error: -else-error-)
                (xor
                 (match :error:.$.error_code 10001
                  (ap -if-error- -if-else-error-)
                 )
                 (ap -else-error- -if-else-error-)
                )
               )
               (fail -if-else-error-)
              )
             )
            )
           )
          )
         )
        )
       )
       (canon %init_peer_id% $latest  #-latest-fix-0)
      )
      (ap #-latest-fix-0 -latest-flat-0)
     )
    )
   )
   (new -if-error-
    (xor
     (mismatch -latest-flat-0 []
      (seq
       (seq
        (seq
         (seq
          (seq
           (new $joined_deals-0
            (seq
             (seq
              (seq
               (seq
                (call %init_peer_id% (-spell_id-arg- "list_get_strings") ["joined_deals"] ret-2)
                (xor
                 (match ret-2.$.success true
                  (ap false not)
                 )
                 (ap true not)
                )
               )
               (new -if-else-error-
                (new -else-error-
                 (new -if-error-
                  (xor
                   (match not true
                    (seq
                     (seq
                      (seq
                       (new $array-inline-1
                        (seq
                         (seq
                          (ap "can't restrive joined deals" $array-inline-1)
                          (ap ret-2.$.error $array-inline-1)
                         )
                         (canon %init_peer_id% $array-inline-1  #array-inline-1-0)
                        )
                       )
                       (par
                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-1-0])
                        (null)
                       )
                      )
                      (call %init_peer_id% ("json" "stringify") [#array-inline-1-0] ret-3)
                     )
                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-3] ret-4)
                    )
                   )
                   (seq
                    (ap :error: -if-error-)
                    (xor
                     (match :error:.$.error_code 10001
                      (fold ret-2.$.strings joined_deal_str-0
                       (seq
                        (xor
                         (seq
                          (call %init_peer_id% ("json" "parse") [joined_deal_str-0] ret-5)
                          (ap ret-5 $joined_deals-0)
                         )
                         (seq
                          (seq
                           (seq
                            (new $array-inline-2
                             (seq
                              (seq
                               (seq
                                (ap "error parsing JoinedDeal" $array-inline-2)
                                (ap joined_deal_str-0 $array-inline-2)
                               )
                               (ap :error: $array-inline-2)
                              )
                              (canon %init_peer_id% $array-inline-2  #array-inline-2-0)
                             )
                            )
                            (par
                             (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-2-0])
                             (null)
                            )
                           )
                           (call %init_peer_id% ("json" "stringify") [#array-inline-2-0] ret-6)
                          )
                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-6] ret-7)
                         )
                        )
                        (next joined_deal_str-0)
                       )
                       (null)
                      )
                     )
                     (seq
                      (seq
                       (ap :error: -else-error-)
                       (xor
                        (match :error:.$.error_code 10001
                         (ap -if-error- -if-else-error-)
                        )
                        (ap -else-error- -if-else-error-)
                       )
                      )
                      (fail -if-else-error-)
                     )
                    )
                   )
                  )
                 )
                )
               )
              )
              (canon %init_peer_id% $joined_deals-0  #-joined_deals-fix-0)
             )
             (ap #-joined_deals-fix-0 -joined_deals-flat-0)
            )
           )
           (xor
            (seq
             (new $left-0
              (seq
               (seq
                (seq
                 (seq
                  (seq
                   (seq
                    (seq
                     (seq
                      (seq
                       (seq
                        (seq
                         (new $result
                          (seq
                           (seq
                            (seq
                             (seq
                              (call %init_peer_id% (-spell_id-arg- "get_string") ["last_seen_block"] ret-8)
                              (xor
                               (match ret-8.$.success true
                                (ap false not-0)
                               )
                               (ap true not-0)
                              )
                             )
                             (new -if-else-error-
                              (new -else-error-
                               (new -if-error-
                                (xor
                                 (match not-0 true
                                  (seq
                                   (seq
                                    (seq
                                     (new $array-inline-3
                                      (seq
                                       (seq
                                        (seq
                                         (ap "get_string failed" $array-inline-3)
                                         (ap "last_seen_block" $array-inline-3)
                                        )
                                        (ap ret-8.$.error $array-inline-3)
                                       )
                                       (canon %init_peer_id% $array-inline-3  #array-inline-3-0)
                                      )
                                     )
                                     (par
                                      (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-3-0])
                                      (null)
                                     )
                                    )
                                    (call %init_peer_id% ("json" "stringify") [#array-inline-3-0] ret-9)
                                   )
                                   (call %init_peer_id% (-spell_id-arg- "store_log") [ret-9] ret-10)
                                  )
                                 )
                                 (seq
                                  (ap :error: -if-error-)
                                  (xor
                                   (match :error:.$.error_code 10001
                                    (seq
                                     (xor
                                      (match ret-8.$.absent true
                                       (ap false not-1)
                                      )
                                      (ap true not-1)
                                     )
                                     (new -if-error-
                                      (xor
                                       (match not-1 true
                                        (ap ret-8.$.str $result)
                                       )
                                       (seq
                                        (ap :error: -if-error-)
                                        (xor
                                         (match :error:.$.error_code 10001
                                          (null)
                                         )
                                         (fail -if-error-)
                                        )
                                       )
                                      )
                                     )
                                    )
                                   )
                                   (seq
                                    (seq
                                     (ap :error: -else-error-)
                                     (xor
                                      (match :error:.$.error_code 10001
                                       (ap -if-error- -if-else-error-)
                                      )
                                      (ap -else-error- -if-else-error-)
                                     )
                                    )
                                    (fail -if-else-error-)
                                   )
                                  )
                                 )
                                )
                               )
                              )
                             )
                            )
                            (canon %init_peer_id% $result  #-result-fix-0)
                           )
                           (ap #-result-fix-0 -result-flat-0)
                          )
                         )
                         (new $array-inline-4
                          (seq
                           (seq
                            (ap "maybe_last_seen is" $array-inline-4)
                            (ap -result-flat-0 $array-inline-4)
                           )
                           (canon %init_peer_id% $array-inline-4  #array-inline-4-0)
                          )
                         )
                        )
                        (par
                         (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-4-0])
                         (null)
                        )
                       )
                       (call %init_peer_id% ("json" "stringify") [#array-inline-4-0] ret-11)
                      )
                      (call %init_peer_id% (-spell_id-arg- "store_log") [ret-11] ret-12)
                     )
                     (new -if-else-error-
                      (new -else-error-
                       (new -if-error-
                        (xor
                         (match -result-flat-0 []
                          (seq
                           (seq
                            (seq
                             (seq
                              (seq
                               (seq
                                (new $left-1
                                 (seq
                                  (seq
                                   (seq
                                    (new $from_block-1
                                     (seq
                                      (seq
                                       (new $result-0
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (call %init_peer_id% (-spell_id-arg- "get_string") ["from_block"] ret-13)
                                            (xor
                                             (match ret-13.$.success true
                                              (ap false not-2)
                                             )
                                             (ap true not-2)
                                            )
                                           )
                                           (new -if-else-error-
                                            (new -else-error-
                                             (new -if-error-
                                              (xor
                                               (match not-2 true
                                                (seq
                                                 (seq
                                                  (seq
                                                   (new $array-inline-5
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (ap "get_string failed" $array-inline-5)
                                                       (ap "from_block" $array-inline-5)
                                                      )
                                                      (ap ret-13.$.error $array-inline-5)
                                                     )
                                                     (canon %init_peer_id% $array-inline-5  #array-inline-5-0)
                                                    )
                                                   )
                                                   (par
                                                    (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-5-0])
                                                    (null)
                                                   )
                                                  )
                                                  (call %init_peer_id% ("json" "stringify") [#array-inline-5-0] ret-14)
                                                 )
                                                 (call %init_peer_id% (-spell_id-arg- "store_log") [ret-14] ret-15)
                                                )
                                               )
                                               (seq
                                                (ap :error: -if-error-)
                                                (xor
                                                 (match :error:.$.error_code 10001
                                                  (seq
                                                   (xor
                                                    (match ret-13.$.absent true
                                                     (ap false not-3)
                                                    )
                                                    (ap true not-3)
                                                   )
                                                   (new -if-error-
                                                    (xor
                                                     (match not-3 true
                                                      (ap ret-13.$.str $result-0)
                                                     )
                                                     (seq
                                                      (ap :error: -if-error-)
                                                      (xor
                                                       (match :error:.$.error_code 10001
                                                        (null)
                                                       )
                                                       (fail -if-error-)
                                                      )
                                                     )
                                                    )
                                                   )
                                                  )
                                                 )
                                                 (seq
                                                  (seq
                                                   (ap :error: -else-error-)
                                                   (xor
                                                    (match :error:.$.error_code 10001
                                                     (ap -if-error- -if-else-error-)
                                                    )
                                                    (ap -else-error- -if-else-error-)
                                                   )
                                                  )
                                                  (fail -if-else-error-)
                                                 )
                                                )
                                               )
                                              )
                                             )
                                            )
                                           )
                                          )
                                          (canon %init_peer_id% $result-0  #-result-fix-0-0)
                                         )
                                         (ap #-result-fix-0-0 -result-flat-0-0)
                                        )
                                       )
                                       (new -if-else-error-
                                        (new -else-error-
                                         (new -if-error-
                                          (xor
                                           (match -result-flat-0-0 []
                                            (ap "latest" $from_block-1)
                                           )
                                           (seq
                                            (ap :error: -if-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (seq
                                               (call %init_peer_id% ("json" "parse") [-result-flat-0-0.$.[0]] ret-16)
                                               (ap ret-16 $from_block-1)
                                              )
                                             )
                                             (seq
                                              (seq
                                               (ap :error: -else-error-)
                                               (xor
                                                (match :error:.$.error_code 10001
                                                 (ap -if-error- -if-else-error-)
                                                )
                                                (ap -else-error- -if-else-error-)
                                               )
                                              )
                                              (fail -if-else-error-)
                                             )
                                            )
                                           )
                                          )
                                         )
                                        )
                                       )
                                      )
                                      (new $from_block-1_test
                                       (seq
                                        (seq
                                         (fold $from_block-1 from_block-1_fold_var
                                          (seq
                                           (seq
                                            (ap from_block-1_fold_var $from_block-1_test)
                                            (canon %init_peer_id% $from_block-1_test  #from_block-1_iter_canon)
                                           )
                                           (xor
                                            (match #from_block-1_iter_canon.length 1
                                             (null)
                                            )
                                            (next from_block-1_fold_var)
                                           )
                                          )
                                          (never)
                                         )
                                         (canon %init_peer_id% $from_block-1_test  #from_block-1_result_canon)
                                        )
                                        (ap #from_block-1_result_canon from_block-1_gate)
                                       )
                                      )
                                     )
                                    )
                                    (new -if-else-error-
                                     (new -else-error-
                                      (new -if-error-
                                       (xor
                                        (match from_block-1_gate.$.[0] "latest"
                                         (seq
                                          (new $latest-1
                                           (seq
                                            (seq
                                             (seq
                                              (call %init_peer_id% ("chain_connector" "latest_block_number") [-chain-arg-.$.api_endpoint] ret-17)
                                              (new -if-else-error-
                                               (new -else-error-
                                                (new -if-error-
                                                 (xor
                                                  (match ret-17.$.success true
                                                   (ap ret-17.$.number_hex $latest-1)
                                                  )
                                                  (seq
                                                   (ap :error: -if-error-)
                                                   (xor
                                                    (match :error:.$.error_code 10001
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (new $array-inline-6
                                                         (seq
                                                          (seq
                                                           (ap "error retrieving latest block number" $array-inline-6)
                                                           (ap ret-17.$.error $array-inline-6)
                                                          )
                                                          (canon %init_peer_id% $array-inline-6  #array-inline-6-0)
                                                         )
                                                        )
                                                        (par
                                                         (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-6-0])
                                                         (null)
                                                        )
                                                       )
                                                       (call %init_peer_id% ("json" "stringify") [#array-inline-6-0] ret-18)
                                                      )
                                                      (call %init_peer_id% (-spell_id-arg- "store_log") [ret-18] ret-19)
                                                     )
                                                    )
                                                    (seq
                                                     (seq
                                                      (ap :error: -else-error-)
                                                      (xor
                                                       (match :error:.$.error_code 10001
                                                        (ap -if-error- -if-else-error-)
                                                       )
                                                       (ap -else-error- -if-else-error-)
                                                      )
                                                     )
                                                     (fail -if-else-error-)
                                                    )
                                                   )
                                                  )
                                                 )
                                                )
                                               )
                                              )
                                             )
                                             (canon %init_peer_id% $latest-1  #-latest-fix-0-0)
                                            )
                                            (ap #-latest-fix-0-0 -latest-flat-0-0)
                                           )
                                          )
                                          (new -if-error-
                                           (xor
                                            (mismatch -latest-flat-0-0 []
                                             (ap -latest-flat-0-0.$.[0] $left-1)
                                            )
                                            (seq
                                             (ap :error: -if-error-)
                                             (xor
                                              (match :error:.$.error_code 10002
                                               (null)
                                              )
                                              (fail -if-error-)
                                             )
                                            )
                                           )
                                          )
                                         )
                                        )
                                        (seq
                                         (ap :error: -if-error-)
                                         (xor
                                          (match :error:.$.error_code 10001
                                           (new -if-else-error-
                                            (new -else-error-
                                             (new -if-error-
                                              (xor
                                               (match from_block-1_gate.$.[0] "earliest"
                                                (ap "0x0" $left-1)
                                               )
                                               (seq
                                                (ap :error: -if-error-)
                                                (xor
                                                 (match :error:.$.error_code 10001
                                                  (ap from_block-1_gate.$.[0] $left-1)
                                                 )
                                                 (seq
                                                  (seq
                                                   (ap :error: -else-error-)
                                                   (xor
                                                    (match :error:.$.error_code 10001
                                                     (ap -if-error- -if-else-error-)
                                                    )
                                                    (ap -else-error- -if-else-error-)
                                                   )
                                                  )
                                                  (fail -if-else-error-)
                                                 )
                                                )
                                               )
                                              )
                                             )
                                            )
                                           )
                                          )
                                          (seq
                                           (seq
                                            (ap :error: -else-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (ap -if-error- -if-else-error-)
                                             )
                                             (ap -else-error- -if-else-error-)
                                            )
                                           )
                                           (fail -if-else-error-)
                                          )
                                         )
                                        )
                                       )
                                      )
                                     )
                                    )
                                   )
                                   (canon %init_peer_id% $left-1  #-left-fix-0-0)
                                  )
                                  (ap #-left-fix-0-0 -left-flat-0-0)
                                 )
                                )
                                (new $array-inline-7
                                 (seq
                                  (seq
                                   (ap "init: will set last seen to" $array-inline-7)
                                   (ap -left-flat-0-0 $array-inline-7)
                                  )
                                  (canon %init_peer_id% $array-inline-7  #array-inline-7-0)
                                 )
                                )
                               )
                               (par
                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-7-0])
                                (null)
                               )
                              )
                              (call %init_peer_id% ("json" "stringify") [#array-inline-7-0] ret-20)
                             )
                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-20] ret-21)
                            )
                            (new -if-error-
                             (xor
                              (mismatch -left-flat-0-0 []
                               (seq
                                (seq
                                 (seq
                                  (seq
                                   (new $array-inline-8
                                    (seq
                                     (seq
                                      (ap "will set last seen to" $array-inline-8)
                                      (ap -left-flat-0-0.$.[0] $array-inline-8)
                                     )
                                     (canon %init_peer_id% $array-inline-8  #array-inline-8-0)
                                    )
                                   )
                                   (par
                                    (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-8-0])
                                    (null)
                                   )
                                  )
                                  (call %init_peer_id% ("json" "stringify") [#array-inline-8-0] ret-22)
                                 )
                                 (call %init_peer_id% (-spell_id-arg- "store_log") [ret-22] ret-23)
                                )
                                (xor
                                 (seq
                                  (call %init_peer_id% (-spell_id-arg- "set_string") ["last_seen_block" -left-flat-0-0.$.[0]] ret-24)
                                  (new -if-else-error-
                                   (new -else-error-
                                    (new -if-error-
                                     (xor
                                      (match ret-24.$.success true
                                       (seq
                                        (seq
                                         (seq
                                          (new $array-inline-9
                                           (seq
                                            (seq
                                             (ap "saved last seen" $array-inline-9)
                                             (ap -left-flat-0-0.$.[0] $array-inline-9)
                                            )
                                            (canon %init_peer_id% $array-inline-9  #array-inline-9-0)
                                           )
                                          )
                                          (par
                                           (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-9-0])
                                           (null)
                                          )
                                         )
                                         (call %init_peer_id% ("json" "stringify") [#array-inline-9-0] ret-25)
                                        )
                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-25] ret-26)
                                       )
                                      )
                                      (seq
                                       (ap :error: -if-error-)
                                       (xor
                                        (match :error:.$.error_code 10001
                                         (seq
                                          (seq
                                           (seq
                                            (new $array-inline-10
                                             (seq
                                              (seq
                                               (ap "error saving last_seen_block" $array-inline-10)
                                               (ap ret-24.$.error $array-inline-10)
                                              )
                                              (canon %init_peer_id% $array-inline-10  #array-inline-10-0)
                                             )
                                            )
                                            (par
                                             (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-10-0])
                                             (null)
                                            )
                                           )
                                           (call %init_peer_id% ("json" "stringify") [#array-inline-10-0] ret-27)
                                          )
                                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-27] ret-28)
                                         )
                                        )
                                        (seq
                                         (seq
                                          (ap :error: -else-error-)
                                          (xor
                                           (match :error:.$.error_code 10001
                                            (ap -if-error- -if-else-error-)
                                           )
                                           (ap -else-error- -if-else-error-)
                                          )
                                         )
                                         (fail -if-else-error-)
                                        )
                                       )
                                      )
                                     )
                                    )
                                   )
                                  )
                                 )
                                 (seq
                                  (seq
                                   (seq
                                    (new $array-inline-11
                                     (seq
                                      (seq
                                       (ap "error saving last_seen_block" $array-inline-11)
                                       (ap :error: $array-inline-11)
                                      )
                                      (canon %init_peer_id% $array-inline-11  #array-inline-11-0)
                                     )
                                    )
                                    (par
                                     (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-11-0])
                                     (null)
                                    )
                                   )
                                   (call %init_peer_id% ("json" "stringify") [#array-inline-11-0] ret-29)
                                  )
                                  (call %init_peer_id% (-spell_id-arg- "store_log") [ret-29] ret-30)
                                 )
                                )
                               )
                              )
                              (seq
                               (ap :error: -if-error-)
                               (xor
                                (match :error:.$.error_code 10002
                                 (null)
                                )
                                (fail -if-error-)
                               )
                              )
                             )
                            )
                           )
                           (new -if-error-
                            (xor
                             (mismatch -left-flat-0-0 []
                              (ap -left-flat-0-0.$.[0] $left-0)
                             )
                             (seq
                              (ap :error: -if-error-)
                              (xor
                               (match :error:.$.error_code 10002
                                (null)
                               )
                               (fail -if-error-)
                              )
                             )
                            )
                           )
                          )
                         )
                         (seq
                          (ap :error: -if-error-)
                          (xor
                           (match :error:.$.error_code 10001
                            (seq
                             (seq
                              (seq
                               (seq
                                (call %init_peer_id% ("chain_connector" "hex_add") [-result-flat-0.$.[0] 1] ret-31)
                                (xor
                                 (match ret-31.$.success true
                                  (ap false not-4)
                                 )
                                 (ap true not-4)
                                )
                               )
                               (new -if-error-
                                (xor
                                 (match not-4 true
                                  (seq
                                   (seq
                                    (seq
                                     (new $array-inline-12
                                      (seq
                                       (seq
                                        (seq
                                         (ap "hex_add failed" $array-inline-12)
                                         (ap -result-flat-0.$.[0] $array-inline-12)
                                        )
                                        (ap 1 $array-inline-12)
                                       )
                                       (canon %init_peer_id% $array-inline-12  #array-inline-12-0)
                                      )
                                     )
                                     (par
                                      (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-12-0])
                                      (null)
                                     )
                                    )
                                    (call %init_peer_id% ("json" "stringify") [#array-inline-12-0] ret-32)
                                   )
                                   (call %init_peer_id% (-spell_id-arg- "store_log") [ret-32] ret-33)
                                  )
                                 )
                                 (seq
                                  (ap :error: -if-error-)
                                  (xor
                                   (match :error:.$.error_code 10001
                                    (null)
                                   )
                                   (fail -if-error-)
                                  )
                                 )
                                )
                               )
                              )
                              (ap ret-31.$.hex ret-31_flat)
                             )
                             (new -if-else-error-
                              (new -else-error-
                               (new -if-error-
                                (xor
                                 (mismatch ret-31_flat []
                                  (ap ret-31_flat.$.[0] $left-0)
                                 )
                                 (seq
                                  (ap :error: -if-error-)
                                  (xor
                                   (match :error:.$.error_code 10002
                                    (ap -result-flat-0.$.[0] $left-0)
                                   )
                                   (seq
                                    (seq
                                     (ap :error: -else-error-)
                                     (xor
                                      (match :error:.$.error_code 10001
                                       (ap -if-error- -if-else-error-)
                                      )
                                      (ap -else-error- -if-else-error-)
                                     )
                                    )
                                    (fail -if-else-error-)
                                   )
                                  )
                                 )
                                )
                               )
                              )
                             )
                            )
                           )
                           (seq
                            (seq
                             (ap :error: -else-error-)
                             (xor
                              (match :error:.$.error_code 10001
                               (ap -if-error- -if-else-error-)
                              )
                              (ap -else-error- -if-else-error-)
                             )
                            )
                            (fail -if-else-error-)
                           )
                          )
                         )
                        )
                       )
                      )
                     )
                    )
                    (new $array-inline-13
                     (seq
                      (seq
                       (seq
                        (ap "left boundary will be" $array-inline-13)
                        (canon %init_peer_id% $left-0  #push-to-stream-519)
                       )
                       (ap #push-to-stream-519 $array-inline-13)
                      )
                      (canon %init_peer_id% $array-inline-13  #array-inline-13-0)
                     )
                    )
                   )
                   (par
                    (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-13-0])
                    (null)
                   )
                  )
                  (call %init_peer_id% ("json" "stringify") [#array-inline-13-0] ret-34)
                 )
                 (call %init_peer_id% (-spell_id-arg- "store_log") [ret-34] ret-35)
                )
                (canon %init_peer_id% $left-0  #-left-fix-0)
               )
               (ap #-left-fix-0 -left-flat-0)
              )
             )
             (new -if-else-error-
              (new -else-error-
               (new -if-error-
                (xor
                 (mismatch -left-flat-0 []
                  (seq
                   (new $poll-0
                    (seq
                     (seq
                      (seq
                       (seq
                        (call %init_peer_id% ("chain_connector" "poll_deal_matches") [-chain-arg- -left-flat-0.$.[0]] ret-36)
                        (xor
                         (match ret-36.$.success true
                          (ap false not-5)
                         )
                         (ap true not-5)
                        )
                       )
                       (new -if-else-error-
                        (new -else-error-
                         (new -if-error-
                          (xor
                           (match not-5 true
                            (seq
                             (seq
                              (seq
                               (new $array-inline-14
                                (seq
                                 (seq
                                  (ap "error polling deal created events" $array-inline-14)
                                  (ap ret-36.$.error $array-inline-14)
                                 )
                                 (canon %init_peer_id% $array-inline-14  #array-inline-14-0)
                                )
                               )
                               (par
                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-14-0])
                                (null)
                               )
                              )
                              (call %init_peer_id% ("json" "stringify") [#array-inline-14-0] ret-37)
                             )
                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-37] ret-38)
                            )
                           )
                           (seq
                            (ap :error: -if-error-)
                            (xor
                             (match :error:.$.error_code 10001
                              (seq
                               (seq
                                (seq
                                 (seq
                                  (seq
                                   (seq
                                    (ap ret-36.$.logs ret-36_flat)
                                    (new $array-inline-15
                                     (seq
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (ap ret-36_flat ret-36_flat_to_functor)
                                           (ap ret-36_flat_to_functor.length ret-36_flat_length)
                                          )
                                          (ap "new deals from poll:" $array-inline-15)
                                         )
                                         (ap ret-36_flat_length $array-inline-15)
                                        )
                                        (ap "from block:" $array-inline-15)
                                       )
                                       (ap -left-flat-0.$.[0] $array-inline-15)
                                      )
                                      (canon %init_peer_id% $array-inline-15  #array-inline-15-0)
                                     )
                                    )
                                   )
                                   (par
                                    (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-15-0])
                                    (null)
                                   )
                                  )
                                  (call %init_peer_id% ("json" "stringify") [#array-inline-15-0] ret-39)
                                 )
                                 (call %init_peer_id% (-spell_id-arg- "store_log") [ret-39] ret-40)
                                )
                                (new %Poll_obj_map
                                 (seq
                                  (seq
                                   (ap ("logs" ret-36_flat) %Poll_obj_map)
                                   (ap ("right_boundary" ret-36.$.right_boundary) %Poll_obj_map)
                                  )
                                  (canon %init_peer_id% %Poll_obj_map  Poll_obj)
                                 )
                                )
                               )
                               (ap Poll_obj $poll-0)
                              )
                             )
                             (seq
                              (seq
                               (ap :error: -else-error-)
                               (xor
                                (match :error:.$.error_code 10001
                                 (ap -if-error- -if-else-error-)
                                )
                                (ap -else-error- -if-else-error-)
                               )
                              )
                              (fail -if-else-error-)
                             )
                            )
                           )
                          )
                         )
                        )
                       )
                      )
                      (canon %init_peer_id% $poll-0  #-poll-fix-0)
                     )
                     (ap #-poll-fix-0 -poll-flat-0)
                    )
                   )
                   (new -if-error-
                    (xor
                     (mismatch -poll-flat-0 []
                      (seq
                       (seq
                        (seq
                         (seq
                          (seq
                           (seq
                            (seq
                             (seq
                              (seq
                               (seq
                                (new $new
                                 (seq
                                  (seq
                                   (fold -poll-flat-0.$.[0].logs match-0
                                    (seq
                                     (new $joined
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (ap match-0.$.info match-0_flat)
                                           (ap match-0_flat.$.deal_id match-0_flat_flat)
                                          )
                                          (new $created
                                           (seq
                                            (seq
                                             (call %init_peer_id% ("worker" "get_worker_id") [match-0_flat_flat] ret-41)
                                             (new -if-else-error-
                                              (new -else-error-
                                               (new -if-error-
                                                (xor
                                                 (mismatch ret-41 []
                                                  (ap true $created)
                                                 )
                                                 (seq
                                                  (ap :error: -if-error-)
                                                  (xor
                                                   (match :error:.$.error_code 10002
                                                    (ap false $created)
                                                   )
                                                   (seq
                                                    (seq
                                                     (ap :error: -else-error-)
                                                     (xor
                                                      (match :error:.$.error_code 10001
                                                       (ap -if-error- -if-else-error-)
                                                      )
                                                      (ap -else-error- -if-else-error-)
                                                     )
                                                    )
                                                    (fail -if-else-error-)
                                                   )
                                                  )
                                                 )
                                                )
                                               )
                                              )
                                             )
                                            )
                                            (new $created_test
                                             (seq
                                              (seq
                                               (fold $created created_fold_var
                                                (seq
                                                 (seq
                                                  (ap created_fold_var $created_test)
                                                  (canon %init_peer_id% $created_test  #created_iter_canon)
                                                 )
                                                 (xor
                                                  (match #created_iter_canon.length 1
                                                   (null)
                                                  )
                                                  (next created_fold_var)
                                                 )
                                                )
                                                (never)
                                               )
                                               (canon %init_peer_id% $created_test  #created_result_canon)
                                              )
                                              (ap #created_result_canon created_gate)
                                             )
                                            )
                                           )
                                          )
                                         )
                                         (new -if-error-
                                          (xor
                                           (match created_gate.$.[0] true
                                            (fold -joined_deals-flat-0 deal-0
                                             (seq
                                              (new -if-error-
                                               (xor
                                                (match match-0_flat_flat deal-0.$.deal_id
                                                 (ap true $joined)
                                                )
                                                (seq
                                                 (ap :error: -if-error-)
                                                 (xor
                                                  (match :error:.$.error_code 10001
                                                   (null)
                                                  )
                                                  (fail -if-error-)
                                                 )
                                                )
                                               )
                                              )
                                              (next deal-0)
                                             )
                                             (null)
                                            )
                                           )
                                           (seq
                                            (ap :error: -if-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (null)
                                             )
                                             (fail -if-error-)
                                            )
                                           )
                                          )
                                         )
                                        )
                                        (canon %init_peer_id% $joined  #joined_canon)
                                       )
                                       (new -if-else-error-
                                        (new -else-error-
                                         (new -if-error-
                                          (xor
                                           (match #joined_canon []
                                            (ap match-0 $new)
                                           )
                                           (seq
                                            (ap :error: -if-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" match-0_flat_flat ": "] ret-42)
                                                  (par
                                                   (call %init_peer_id% ("run-console" "print") [ret-42 "deal is already joined"])
                                                   (null)
                                                  )
                                                 )
                                                 (call %init_peer_id% ("json" "stringify") ["deal is already joined"] ret-43)
                                                )
                                                (call %init_peer_id% ("op" "concat_strings") [ret-42 ret-43] ret-44)
                                               )
                                               (call %init_peer_id% (-spell_id-arg- "store_log") [ret-44] ret-45)
                                              )
                                             )
                                             (seq
                                              (seq
                                               (ap :error: -else-error-)
                                               (xor
                                                (match :error:.$.error_code 10001
                                                 (ap -if-error- -if-else-error-)
                                                )
                                                (ap -else-error- -if-else-error-)
                                               )
                                              )
                                              (fail -if-else-error-)
                                             )
                                            )
                                           )
                                          )
                                         )
                                        )
                                       )
                                      )
                                     )
                                     (next match-0)
                                    )
                                    (null)
                                   )
                                   (canon %init_peer_id% $new  #-new-fix-0)
                                  )
                                  (ap #-new-fix-0 -new-flat-0)
                                 )
                                )
                                (fold -new-flat-0 log-16-0
                                 (seq
                                  (seq
                                   (seq
                                    (seq
                                     (ap log-16-0.$.info log-16-0_flat)
                                     (ap log-16-0_flat.$.deal_id log-16-0_flat_flat)
                                    )
                                    (new $error-0
                                     (new $worker_id-0
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (seq
                                             (seq
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (new $array-inline-16
                                                   (seq
                                                    (seq
                                                     (ap "joining a deal from_block" $array-inline-16)
                                                     (ap log-16-0.$.block_number $array-inline-16)
                                                    )
                                                    (canon %init_peer_id% $array-inline-16  #array-inline-16-0)
                                                   )
                                                  )
                                                  (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-46)
                                                 )
                                                 (par
                                                  (call %init_peer_id% ("run-console" "print") [ret-46 #array-inline-16-0])
                                                  (null)
                                                 )
                                                )
                                                (call %init_peer_id% ("json" "stringify") [#array-inline-16-0] ret-47)
                                               )
                                               (call %init_peer_id% ("op" "concat_strings") [ret-46 ret-47] ret-48)
                                              )
                                              (call %init_peer_id% (-spell_id-arg- "store_log") [ret-48] ret-49)
                                             )
                                             (xor
                                              (seq
                                               (new $worker_id-1
                                                (seq
                                                 (seq
                                                  (seq
                                                   (call %init_peer_id% ("worker" "get_worker_id") [log-16-0_flat_flat] ret-50)
                                                   (new -if-else-error-
                                                    (new -else-error-
                                                     (new -if-error-
                                                      (xor
                                                       (match ret-50 []
                                                        (xor
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (call %init_peer_id% ("worker" "create") [log-16-0_flat_flat] ret-51)
                                                                (ap ret-51 $worker_id-1)
                                                               )
                                                               (new $array-inline-17
                                                                (seq
                                                                 (seq
                                                                  (seq
                                                                   (new $worker_id-1_test
                                                                    (seq
                                                                     (seq
                                                                      (fold $worker_id-1 worker_id-1_fold_var
                                                                       (seq
                                                                        (seq
                                                                         (ap worker_id-1_fold_var $worker_id-1_test)
                                                                         (canon %init_peer_id% $worker_id-1_test  #worker_id-1_iter_canon)
                                                                        )
                                                                        (xor
                                                                         (match #worker_id-1_iter_canon.length 1
                                                                          (null)
                                                                         )
                                                                         (next worker_id-1_fold_var)
                                                                        )
                                                                       )
                                                                       (never)
                                                                      )
                                                                      (canon %init_peer_id% $worker_id-1_test  #worker_id-1_result_canon)
                                                                     )
                                                                     (ap #worker_id-1_result_canon worker_id-1_gate)
                                                                    )
                                                                   )
                                                                   (ap "created worker for deal" $array-inline-17)
                                                                  )
                                                                  (ap worker_id-1_gate.$.[0] $array-inline-17)
                                                                 )
                                                                 (canon %init_peer_id% $array-inline-17  #array-inline-17-0)
                                                                )
                                                               )
                                                              )
                                                              (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-52)
                                                             )
                                                             (par
                                                              (call %init_peer_id% ("run-console" "print") [ret-52 #array-inline-17-0])
                                                              (null)
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [#array-inline-17-0] ret-53)
                                                           )
                                                           (call %init_peer_id% ("op" "concat_strings") [ret-52 ret-53] ret-54)
                                                          )
                                                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-54] ret-55)
                                                         )
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (new $array-inline-18
                                                               (seq
                                                                (seq
                                                                 (ap "error creating worker" $array-inline-18)
                                                                 (ap :error:.$.message $array-inline-18)
                                                                )
                                                                (canon %init_peer_id% $array-inline-18  #array-inline-18-0)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-56)
                                                             )
                                                             (par
                                                              (call %init_peer_id% ("run-console" "print") [ret-56 #array-inline-18-0])
                                                              (null)
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [#array-inline-18-0] ret-57)
                                                           )
                                                           (call %init_peer_id% ("op" "concat_strings") [ret-56 ret-57] ret-58)
                                                          )
                                                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-58] ret-59)
                                                         )
                                                        )
                                                       )
                                                       (seq
                                                        (ap :error: -if-error-)
                                                        (xor
                                                         (match :error:.$.error_code 10001
                                                          (ap ret-50.$.[0] $worker_id-1)
                                                         )
                                                         (seq
                                                          (seq
                                                           (ap :error: -else-error-)
                                                           (xor
                                                            (match :error:.$.error_code 10001
                                                             (ap -if-error- -if-else-error-)
                                                            )
                                                            (ap -else-error- -if-else-error-)
                                                           )
                                                          )
                                                          (fail -if-else-error-)
                                                         )
                                                        )
                                                       )
                                                      )
                                                     )
                                                    )
                                                   )
                                                  )
                                                  (canon %init_peer_id% $worker_id-1  #-worker_id-fix-0-0)
                                                 )
                                                 (ap #-worker_id-fix-0-0 -worker_id-flat-0-0)
                                                )
                                               )
                                               (new -if-error-
                                                (xor
                                                 (mismatch -worker_id-flat-0-0 []
                                                  (ap -worker_id-flat-0-0.$.[0] $worker_id-0)
                                                 )
                                                 (seq
                                                  (ap :error: -if-error-)
                                                  (xor
                                                   (match :error:.$.error_code 10002
                                                    (null)
                                                   )
                                                   (fail -if-error-)
                                                  )
                                                 )
                                                )
                                               )
                                              )
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (seq
                                                   (seq
                                                    (seq
                                                     (seq
                                                      (new $array-inline-19
                                                       (seq
                                                        (seq
                                                         (ap "error creating worker" $array-inline-19)
                                                         (ap :error: $array-inline-19)
                                                        )
                                                        (canon %init_peer_id% $array-inline-19  #array-inline-19-0)
                                                       )
                                                      )
                                                      (call %init_peer_id% ("json" "stringify") [#array-inline-19-0] ret-60)
                                                     )
                                                     (ap ret-60 $error-0)
                                                    )
                                                    (new $array-inline-20
                                                     (seq
                                                      (seq
                                                       (ap "error creating worker" $array-inline-20)
                                                       (ap :error: $array-inline-20)
                                                      )
                                                      (canon %init_peer_id% $array-inline-20  #array-inline-20-0)
                                                     )
                                                    )
                                                   )
                                                   (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-61)
                                                  )
                                                  (par
                                                   (call %init_peer_id% ("run-console" "print") [ret-61 #array-inline-20-0])
                                                   (null)
                                                  )
                                                 )
                                                 (call %init_peer_id% ("json" "stringify") [#array-inline-20-0] ret-62)
                                                )
                                                (call %init_peer_id% ("op" "concat_strings") [ret-61 ret-62] ret-63)
                                               )
                                               (call %init_peer_id% (-spell_id-arg- "store_log") [ret-63] ret-64)
                                              )
                                             )
                                            )
                                            (canon %init_peer_id% $worker_id-0  #worker_id-0_canon)
                                           )
                                           (new -if-error-
                                            (xor
                                             (mismatch #worker_id-0_canon []
                                              (seq
                                               (new $settings-0
                                                (seq
                                                 (seq
                                                  (seq
                                                   (new $result-2
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (call %init_peer_id% (-spell_id-arg- "get_string") ["worker_settings"] ret-65)
                                                        (xor
                                                         (match ret-65.$.success true
                                                          (ap false not-6)
                                                         )
                                                         (ap true not-6)
                                                        )
                                                       )
                                                       (new -if-else-error-
                                                        (new -else-error-
                                                         (new -if-error-
                                                          (xor
                                                           (match not-6 true
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (new $array-inline-21
                                                                (seq
                                                                 (seq
                                                                  (seq
                                                                   (ap "get_string failed" $array-inline-21)
                                                                   (ap "worker_settings" $array-inline-21)
                                                                  )
                                                                  (ap ret-65.$.error $array-inline-21)
                                                                 )
                                                                 (canon %init_peer_id% $array-inline-21  #array-inline-21-0)
                                                                )
                                                               )
                                                               (par
                                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-21-0])
                                                                (null)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [#array-inline-21-0] ret-66)
                                                             )
                                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-66] ret-67)
                                                            )
                                                           )
                                                           (seq
                                                            (ap :error: -if-error-)
                                                            (xor
                                                             (match :error:.$.error_code 10001
                                                              (seq
                                                               (xor
                                                                (match ret-65.$.absent true
                                                                 (ap false not-7)
                                                                )
                                                                (ap true not-7)
                                                               )
                                                               (new -if-error-
                                                                (xor
                                                                 (match not-7 true
                                                                  (ap ret-65.$.str $result-2)
                                                                 )
                                                                 (seq
                                                                  (ap :error: -if-error-)
                                                                  (xor
                                                                   (match :error:.$.error_code 10001
                                                                    (null)
                                                                   )
                                                                   (fail -if-error-)
                                                                  )
                                                                 )
                                                                )
                                                               )
                                                              )
                                                             )
                                                             (seq
                                                              (seq
                                                               (ap :error: -else-error-)
                                                               (xor
                                                                (match :error:.$.error_code 10001
                                                                 (ap -if-error- -if-else-error-)
                                                                )
                                                                (ap -else-error- -if-else-error-)
                                                               )
                                                              )
                                                              (fail -if-else-error-)
                                                             )
                                                            )
                                                           )
                                                          )
                                                         )
                                                        )
                                                       )
                                                      )
                                                      (canon %init_peer_id% $result-2  #-result-fix-0-1)
                                                     )
                                                     (ap #-result-fix-0-1 -result-flat-0-1)
                                                    )
                                                   )
                                                   (new -if-error-
                                                    (xor
                                                     (mismatch -result-flat-0-1 []
                                                      (xor
                                                       (seq
                                                        (call %init_peer_id% ("json" "parse") [-result-flat-0-1.$.[0]] ret-68)
                                                        (ap ret-68 $settings-0)
                                                       )
                                                       (seq
                                                        (seq
                                                         (seq
                                                          (new $array-inline-22
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (ap "can't parse worker_settings" $array-inline-22)
                                                               (ap :error: $array-inline-22)
                                                              )
                                                              (ap " original string:" $array-inline-22)
                                                             )
                                                             (ap -result-flat-0-1.$.[0] $array-inline-22)
                                                            )
                                                            (canon %init_peer_id% $array-inline-22  #array-inline-22-0)
                                                           )
                                                          )
                                                          (par
                                                           (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-22-0])
                                                           (null)
                                                          )
                                                         )
                                                         (call %init_peer_id% ("json" "stringify") [#array-inline-22-0] ret-69)
                                                        )
                                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-69] ret-70)
                                                       )
                                                      )
                                                     )
                                                     (seq
                                                      (ap :error: -if-error-)
                                                      (xor
                                                       (match :error:.$.error_code 10002
                                                        (null)
                                                       )
                                                       (fail -if-error-)
                                                      )
                                                     )
                                                    )
                                                   )
                                                  )
                                                  (canon %init_peer_id% $settings-0  #-settings-fix-0)
                                                 )
                                                 (ap #-settings-fix-0 -settings-flat-0)
                                                )
                                               )
                                               (new -if-else-error-
                                                (new -else-error-
                                                 (new -if-error-
                                                  (xor
                                                   (mismatch -settings-flat-0 []
                                                    (seq
                                                     (new $worker_id-0_test
                                                      (seq
                                                       (seq
                                                        (fold $worker_id-0 worker_id-0_fold_var
                                                         (seq
                                                          (seq
                                                           (ap worker_id-0_fold_var $worker_id-0_test)
                                                           (canon %init_peer_id% $worker_id-0_test  #worker_id-0_iter_canon)
                                                          )
                                                          (xor
                                                           (match #worker_id-0_iter_canon.length 1
                                                            (null)
                                                           )
                                                           (next worker_id-0_fold_var)
                                                          )
                                                         )
                                                         (never)
                                                        )
                                                        (canon %init_peer_id% $worker_id-0_test  #worker_id-0_result_canon)
                                                       )
                                                       (ap #worker_id-0_result_canon worker_id-0_gate)
                                                      )
                                                     )
                                                     (xor
                                                      (seq
                                                       (new $-ephemeral-stream-
                                                        (new #-ephemeral-canon-
                                                         (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                        )
                                                       )
                                                       (xor
                                                        (xor
                                                         (xor
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (call worker_id-0_gate.$.[0] ("srv" "resolve_alias") ["worker-spell"] ret-71)
                                                                 (new $array-inline-23
                                                                  (seq
                                                                   (seq
                                                                    (ap "resolved existing worker-spell" $array-inline-23)
                                                                    (ap ret-71 $array-inline-23)
                                                                   )
                                                                   (canon worker_id-0_gate.$.[0] $array-inline-23  #array-inline-23-0)
                                                                  )
                                                                 )
                                                                )
                                                                (new $-ephemeral-stream-
                                                                 (new #-ephemeral-canon-
                                                                  (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                                 )
                                                                )
                                                               )
                                                               (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-72)
                                                              )
                                                              (par
                                                               (call %init_peer_id% ("run-console" "print") [ret-72 #array-inline-23-0])
                                                               (null)
                                                              )
                                                             )
                                                             (call %init_peer_id% ("json" "stringify") [#array-inline-23-0] ret-73)
                                                            )
                                                            (call %init_peer_id% ("op" "concat_strings") [ret-72 ret-73] ret-74)
                                                           )
                                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-74] ret-75)
                                                          )
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (seq
                                                                  (new %WorkerArgs_obj_map
                                                                   (seq
                                                                    (seq
                                                                     (seq
                                                                      (ap ("deal_id" log-16-0_flat_flat) %WorkerArgs_obj_map)
                                                                      (ap ("ipfs" -settings-flat-0.$.[0].ipfs) %WorkerArgs_obj_map)
                                                                     )
                                                                     (ap ("worker_def_cid" log-16-0.$.info.app_cid) %WorkerArgs_obj_map)
                                                                    )
                                                                    (canon worker_id-0_gate.$.[0] %WorkerArgs_obj_map  WorkerArgs_obj)
                                                                   )
                                                                  )
                                                                  (call worker_id-0_gate.$.[0] ("spell" "install") [-settings-flat-0.$.[0].script WorkerArgs_obj -settings-flat-0.$.[0].config "worker-spell"] ret-76)
                                                                 )
                                                                 (new $array-inline-24
                                                                  (seq
                                                                   (seq
                                                                    (ap "created deal spell" $array-inline-24)
                                                                    (ap ret-76 $array-inline-24)
                                                                   )
                                                                   (canon worker_id-0_gate.$.[0] $array-inline-24  #array-inline-24-0)
                                                                  )
                                                                 )
                                                                )
                                                                (new $-ephemeral-stream-
                                                                 (new #-ephemeral-canon-
                                                                  (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                                 )
                                                                )
                                                               )
                                                               (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-77)
                                                              )
                                                              (par
                                                               (call %init_peer_id% ("run-console" "print") [ret-77 #array-inline-24-0])
                                                               (null)
                                                              )
                                                             )
                                                             (call %init_peer_id% ("json" "stringify") [#array-inline-24-0] ret-78)
                                                            )
                                                            (call %init_peer_id% ("op" "concat_strings") [ret-77 ret-78] ret-79)
                                                           )
                                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-79] ret-80)
                                                          )
                                                         )
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (seq
                                                                  (new $array-inline-25
                                                                   (seq
                                                                    (seq
                                                                     (ap "error installing deal spell" $array-inline-25)
                                                                     (ap :error: $array-inline-25)
                                                                    )
                                                                    (canon worker_id-0_gate.$.[0] $array-inline-25  #array-inline-25-0)
                                                                   )
                                                                  )
                                                                  (call worker_id-0_gate.$.[0] ("json" "stringify") [#array-inline-25-0] ret-81)
                                                                 )
                                                                 (ap ret-81 $error-0)
                                                                )
                                                                (new $array-inline-26
                                                                 (seq
                                                                  (seq
                                                                   (ap "error installing deal spell" $array-inline-26)
                                                                   (ap :error: $array-inline-26)
                                                                  )
                                                                  (canon worker_id-0_gate.$.[0] $array-inline-26  #array-inline-26-0)
                                                                 )
                                                                )
                                                               )
                                                               (new $-ephemeral-stream-
                                                                (new #-ephemeral-canon-
                                                                 (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                                )
                                                               )
                                                              )
                                                              (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-82)
                                                             )
                                                             (par
                                                              (call %init_peer_id% ("run-console" "print") [ret-82 #array-inline-26-0])
                                                              (null)
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [#array-inline-26-0] ret-83)
                                                           )
                                                           (call %init_peer_id% ("op" "concat_strings") [ret-82 ret-83] ret-84)
                                                          )
                                                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-84] ret-85)
                                                         )
                                                        )
                                                        (seq
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (new $array-inline-27
                                                                  (seq
                                                                   (seq
                                                                    (ap "cannot create deal spell" $array-inline-27)
                                                                    (ap :error:.$.message $array-inline-27)
                                                                   )
                                                                   (canon worker_id-0_gate.$.[0] $array-inline-27  #array-inline-27-0)
                                                                  )
                                                                 )
                                                                 (call worker_id-0_gate.$.[0] ("json" "stringify") [#array-inline-27-0] ret-86)
                                                                )
                                                                (ap ret-86 $error-0)
                                                               )
                                                               (new $array-inline-28
                                                                (seq
                                                                 (seq
                                                                  (ap "cannot create deal spell, deal join failed" $array-inline-28)
                                                                  (ap :error:.$.message $array-inline-28)
                                                                 )
                                                                 (canon worker_id-0_gate.$.[0] $array-inline-28  #array-inline-28-0)
                                                                )
                                                               )
                                                              )
                                                              (new $-ephemeral-stream-
                                                               (new #-ephemeral-canon-
                                                                (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                               )
                                                              )
                                                             )
                                                             (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-87)
                                                            )
                                                            (par
                                                             (call %init_peer_id% ("run-console" "print") [ret-87 #array-inline-28-0])
                                                             (null)
                                                            )
                                                           )
                                                           (call %init_peer_id% ("json" "stringify") [#array-inline-28-0] ret-88)
                                                          )
                                                          (call %init_peer_id% ("op" "concat_strings") [ret-87 ret-88] ret-89)
                                                         )
                                                         (call %init_peer_id% (-spell_id-arg- "store_log") [ret-89] ret-90)
                                                        )
                                                       )
                                                      )
                                                      (seq
                                                       (seq
                                                        (new $-ephemeral-stream-
                                                         (new #-ephemeral-canon-
                                                          (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                                         )
                                                        )
                                                        (new $-ephemeral-stream-
                                                         (new #-ephemeral-canon-
                                                          (canon %init_peer_id% $-ephemeral-stream-  #-ephemeral-canon-)
                                                         )
                                                        )
                                                       )
                                                       (fail :error:)
                                                      )
                                                     )
                                                    )
                                                   )
                                                   (seq
                                                    (ap :error: -if-error-)
                                                    (xor
                                                     (match :error:.$.error_code 10002
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (new $array-inline-29
                                                               (seq
                                                                (ap "error reading worker settings" $array-inline-29)
                                                                (canon %init_peer_id% $array-inline-29  #array-inline-29-0)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [#array-inline-29-0] ret-91)
                                                             )
                                                             (ap ret-91 $error-0)
                                                            )
                                                            (new $array-inline-30
                                                             (seq
                                                              (ap "error reading worker settings, deal join failed" $array-inline-30)
                                                              (canon %init_peer_id% $array-inline-30  #array-inline-30-0)
                                                             )
                                                            )
                                                           )
                                                           (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-92)
                                                          )
                                                          (par
                                                           (call %init_peer_id% ("run-console" "print") [ret-92 #array-inline-30-0])
                                                           (null)
                                                          )
                                                         )
                                                         (call %init_peer_id% ("json" "stringify") [#array-inline-30-0] ret-93)
                                                        )
                                                        (call %init_peer_id% ("op" "concat_strings") [ret-92 ret-93] ret-94)
                                                       )
                                                       (call %init_peer_id% (-spell_id-arg- "store_log") [ret-94] ret-95)
                                                      )
                                                     )
                                                     (seq
                                                      (seq
                                                       (ap :error: -else-error-)
                                                       (xor
                                                        (match :error:.$.error_code 10001
                                                         (ap -if-error- -if-else-error-)
                                                        )
                                                        (ap -else-error- -if-else-error-)
                                                       )
                                                      )
                                                      (fail -if-else-error-)
                                                     )
                                                    )
                                                   )
                                                  )
                                                 )
                                                )
                                               )
                                              )
                                             )
                                             (seq
                                              (ap :error: -if-error-)
                                              (xor
                                               (match :error:.$.error_code 10002
                                                (null)
                                               )
                                               (fail -if-error-)
                                              )
                                             )
                                            )
                                           )
                                          )
                                          (canon %init_peer_id% $worker_id-0  #-worker_id-fix-0)
                                         )
                                         (ap #-worker_id-fix-0 -worker_id-flat-0)
                                        )
                                        (canon %init_peer_id% $error-0  #-error-fix-0)
                                       )
                                       (ap #-error-fix-0 -error-flat-0)
                                      )
                                     )
                                    )
                                   )
                                   (new -if-else-error-
                                    (new -else-error-
                                     (new -if-error-
                                      (xor
                                       (match -worker_id-flat-0 []
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (seq
                                             (seq
                                              (new %InstallationFailed_obj_map
                                               (seq
                                                (ap ("log" log-16-0) %InstallationFailed_obj_map)
                                                (canon %init_peer_id% %InstallationFailed_obj_map  InstallationFailed_obj)
                                               )
                                              )
                                              (new %FailedDealError_obj_map
                                               (seq
                                                (seq
                                                 (ap ("content" InstallationFailed_obj) %FailedDealError_obj_map)
                                                 (ap ("type" "InstallationFailed") %FailedDealError_obj_map)
                                                )
                                                (canon %init_peer_id% %FailedDealError_obj_map  FailedDealError_obj)
                                               )
                                              )
                                             )
                                             (new %FailedDeal_obj_map
                                              (seq
                                               (seq
                                                (seq
                                                 (ap ("deal_id" log-16-0_flat_flat) %FailedDeal_obj_map)
                                                 (ap ("message" -error-flat-0.$.[0]) %FailedDeal_obj_map)
                                                )
                                                (ap ("payload" FailedDealError_obj) %FailedDeal_obj_map)
                                               )
                                               (canon %init_peer_id% %FailedDeal_obj_map  FailedDeal_obj)
                                              )
                                             )
                                            )
                                            (call %init_peer_id% ("json" "stringify") [FailedDeal_obj] ret-96)
                                           )
                                           (call %init_peer_id% (-spell_id-arg- "list_push_string") ["failed_deals" ret-96] ret-97)
                                          )
                                          (xor
                                           (match ret-97.$.success true
                                            (ap false not-8)
                                           )
                                           (ap true not-8)
                                          )
                                         )
                                         (new -if-error-
                                          (xor
                                           (match not-8 true
                                            (seq
                                             (seq
                                              (seq
                                               (new $array-inline-31
                                                (seq
                                                 (seq
                                                  (seq
                                                   (seq
                                                    (ap "can't store value in list by key" $array-inline-31)
                                                    (ap "failed_deals" $array-inline-31)
                                                   )
                                                   (ap "error:" $array-inline-31)
                                                  )
                                                  (ap ret-97.$.error $array-inline-31)
                                                 )
                                                 (canon %init_peer_id% $array-inline-31  #array-inline-31-0)
                                                )
                                               )
                                               (par
                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-31-0])
                                                (null)
                                               )
                                              )
                                              (call %init_peer_id% ("json" "stringify") [#array-inline-31-0] ret-98)
                                             )
                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-98] ret-99)
                                            )
                                           )
                                           (seq
                                            (ap :error: -if-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (null)
                                             )
                                             (fail -if-error-)
                                            )
                                           )
                                          )
                                         )
                                        )
                                       )
                                       (seq
                                        (ap :error: -if-error-)
                                        (xor
                                         (match :error:.$.error_code 10001
                                          (seq
                                           (seq
                                            (seq
                                             (seq
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (call %init_peer_id% ("chain_connector" "register_worker") [log-16-0.$.info.pat_id -worker_id-flat-0.$.[0] -chain-arg- log-16-0_flat_flat] ret-100)
                                                  (ap ret-100.$.success ret-100_flat)
                                                 )
                                                 (new -if-else-error-
                                                  (new -else-error-
                                                   (new -if-error-
                                                    (xor
                                                     (match ret-100.$.success true
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (new $array-inline-32
                                                                 (seq
                                                                  (seq
                                                                   (ap "registered worker tx_hash" $array-inline-32)
                                                                   (ap ret-100.$.tx_hash $array-inline-32)
                                                                  )
                                                                  (canon %init_peer_id% $array-inline-32  #array-inline-32-0)
                                                                 )
                                                                )
                                                                (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-101)
                                                               )
                                                               (par
                                                                (call %init_peer_id% ("run-console" "print") [ret-101 #array-inline-32-0])
                                                                (null)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [#array-inline-32-0] ret-102)
                                                             )
                                                             (call %init_peer_id% ("op" "concat_strings") [ret-101 ret-102] ret-103)
                                                            )
                                                            (call %init_peer_id% (-spell_id-arg- "store_log") [ret-103] ret-104)
                                                           )
                                                           (new %WorkerTxInfo_obj_map
                                                            (seq
                                                             (seq
                                                              (ap ("deal_id" log-16-0_flat_flat) %WorkerTxInfo_obj_map)
                                                              (ap ("tx_hash" ret-100.$.tx_hash.[0]) %WorkerTxInfo_obj_map)
                                                             )
                                                             (canon %init_peer_id% %WorkerTxInfo_obj_map  WorkerTxInfo_obj)
                                                            )
                                                           )
                                                          )
                                                          (call %init_peer_id% ("json" "stringify") [WorkerTxInfo_obj] ret-105)
                                                         )
                                                         (call %init_peer_id% (-spell_id-arg- "list_push_string") ["worker_registration_txs" ret-105] ret-106)
                                                        )
                                                        (xor
                                                         (match ret-106.$.success true
                                                          (ap false not-9)
                                                         )
                                                         (ap true not-9)
                                                        )
                                                       )
                                                       (new -if-error-
                                                        (xor
                                                         (match not-9 true
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (new $array-inline-33
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (seq
                                                                  (ap "can't store value in list by key" $array-inline-33)
                                                                  (ap "worker_registration_txs" $array-inline-33)
                                                                 )
                                                                 (ap "error:" $array-inline-33)
                                                                )
                                                                (ap ret-106.$.error $array-inline-33)
                                                               )
                                                               (canon %init_peer_id% $array-inline-33  #array-inline-33-0)
                                                              )
                                                             )
                                                             (par
                                                              (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-33-0])
                                                              (null)
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [#array-inline-33-0] ret-107)
                                                           )
                                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-107] ret-108)
                                                          )
                                                         )
                                                         (seq
                                                          (ap :error: -if-error-)
                                                          (xor
                                                           (match :error:.$.error_code 10001
                                                            (null)
                                                           )
                                                           (fail -if-error-)
                                                          )
                                                         )
                                                        )
                                                       )
                                                      )
                                                     )
                                                     (seq
                                                      (ap :error: -if-error-)
                                                      (xor
                                                       (match :error:.$.error_code 10001
                                                        (seq
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (seq
                                                                  (seq
                                                                   (seq
                                                                    (new $array-inline-34
                                                                     (seq
                                                                      (seq
                                                                       (ap "error registering worker" $array-inline-34)
                                                                       (ap ret-100.$.error.[0] $array-inline-34)
                                                                      )
                                                                      (canon %init_peer_id% $array-inline-34  #array-inline-34-0)
                                                                     )
                                                                    )
                                                                    (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-109)
                                                                   )
                                                                   (par
                                                                    (call %init_peer_id% ("run-console" "print") [ret-109 #array-inline-34-0])
                                                                    (null)
                                                                   )
                                                                  )
                                                                  (call %init_peer_id% ("json" "stringify") [#array-inline-34-0] ret-110)
                                                                 )
                                                                 (call %init_peer_id% ("op" "concat_strings") [ret-109 ret-110] ret-111)
                                                                )
                                                                (call %init_peer_id% (-spell_id-arg- "store_log") [ret-111] ret-112)
                                                               )
                                                               (new %TxFailed_obj_map
                                                                (seq
                                                                 (seq
                                                                  (ap ("block_number" []) %TxFailed_obj_map)
                                                                  (ap ("tx_hash" []) %TxFailed_obj_map)
                                                                 )
                                                                 (canon %init_peer_id% %TxFailed_obj_map  TxFailed_obj)
                                                                )
                                                               )
                                                              )
                                                              (new %FailedDealError_obj-0_map
                                                               (seq
                                                                (seq
                                                                 (ap ("content" TxFailed_obj) %FailedDealError_obj-0_map)
                                                                 (ap ("type" "TxFailed") %FailedDealError_obj-0_map)
                                                                )
                                                                (canon %init_peer_id% %FailedDealError_obj-0_map  FailedDealError_obj-0)
                                                               )
                                                              )
                                                             )
                                                             (new %FailedDeal_obj-0_map
                                                              (seq
                                                               (seq
                                                                (seq
                                                                 (ap ("deal_id" log-16-0_flat_flat) %FailedDeal_obj-0_map)
                                                                 (ap ("message" ret-100.$.error.[0]) %FailedDeal_obj-0_map)
                                                                )
                                                                (ap ("payload" FailedDealError_obj-0) %FailedDeal_obj-0_map)
                                                               )
                                                               (canon %init_peer_id% %FailedDeal_obj-0_map  FailedDeal_obj-0)
                                                              )
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [FailedDeal_obj-0] ret-113)
                                                           )
                                                           (call %init_peer_id% (-spell_id-arg- "list_push_string") ["failed_deals" ret-113] ret-114)
                                                          )
                                                          (xor
                                                           (match ret-114.$.success true
                                                            (ap false not-10)
                                                           )
                                                           (ap true not-10)
                                                          )
                                                         )
                                                         (new -if-error-
                                                          (xor
                                                           (match not-10 true
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (new $array-inline-35
                                                                (seq
                                                                 (seq
                                                                  (seq
                                                                   (seq
                                                                    (ap "can't store value in list by key" $array-inline-35)
                                                                    (ap "failed_deals" $array-inline-35)
                                                                   )
                                                                   (ap "error:" $array-inline-35)
                                                                  )
                                                                  (ap ret-114.$.error $array-inline-35)
                                                                 )
                                                                 (canon %init_peer_id% $array-inline-35  #array-inline-35-0)
                                                                )
                                                               )
                                                               (par
                                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-35-0])
                                                                (null)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [#array-inline-35-0] ret-115)
                                                             )
                                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-115] ret-116)
                                                            )
                                                           )
                                                           (seq
                                                            (ap :error: -if-error-)
                                                            (xor
                                                             (match :error:.$.error_code 10001
                                                              (null)
                                                             )
                                                             (fail -if-error-)
                                                            )
                                                           )
                                                          )
                                                         )
                                                        )
                                                       )
                                                       (seq
                                                        (seq
                                                         (ap :error: -else-error-)
                                                         (xor
                                                          (match :error:.$.error_code 10001
                                                           (ap -if-error- -if-else-error-)
                                                          )
                                                          (ap -else-error- -if-else-error-)
                                                         )
                                                        )
                                                        (fail -if-else-error-)
                                                       )
                                                      )
                                                     )
                                                    )
                                                   )
                                                  )
                                                 )
                                                )
                                                (new -if-error-
                                                 (xor
                                                  (match ret-100_flat true
                                                   (xor
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (seq
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (new %JoinedDeal_obj_map
                                                               (seq
                                                                (seq
                                                                 (ap ("deal_id" log-16-0_flat_flat) %JoinedDeal_obj_map)
                                                                 (ap ("worker_id" -worker_id-flat-0.$.[0]) %JoinedDeal_obj_map)
                                                                )
                                                                (canon %init_peer_id% %JoinedDeal_obj_map  JoinedDeal_obj)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [JoinedDeal_obj] ret-117)
                                                             )
                                                             (call %init_peer_id% (-spell_id-arg- "list_push_string") ["joined_deals" ret-117] ret-118)
                                                            )
                                                            (new %DealState_obj_map
                                                             (seq
                                                              (ap ("left_boundary" log-16-0.$.block_number) %DealState_obj_map)
                                                              (canon %init_peer_id% %DealState_obj_map  DealState_obj)
                                                             )
                                                            )
                                                           )
                                                           (call %init_peer_id% ("json" "stringify") [DealState_obj] ret-119)
                                                          )
                                                          (call %init_peer_id% (-spell_id-arg- "set_string") [log-16-0_flat_flat ret-119] ret-120)
                                                         )
                                                         (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-121)
                                                        )
                                                        (par
                                                         (call %init_peer_id% ("run-console" "print") [ret-121 "deal state saved to kv"])
                                                         (null)
                                                        )
                                                       )
                                                       (call %init_peer_id% ("json" "stringify") ["deal state saved to kv"] ret-122)
                                                      )
                                                      (call %init_peer_id% ("op" "concat_strings") [ret-121 ret-122] ret-123)
                                                     )
                                                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-123] ret-124)
                                                    )
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (new $array-inline-36
                                                          (seq
                                                           (seq
                                                            (ap "cannot store deal state, deal join failed" $array-inline-36)
                                                            (ap :error:.$.message $array-inline-36)
                                                           )
                                                           (canon %init_peer_id% $array-inline-36  #array-inline-36-0)
                                                          )
                                                         )
                                                         (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" log-16-0_flat_flat ": "] ret-125)
                                                        )
                                                        (par
                                                         (call %init_peer_id% ("run-console" "print") [ret-125 #array-inline-36-0])
                                                         (null)
                                                        )
                                                       )
                                                       (call %init_peer_id% ("json" "stringify") [#array-inline-36-0] ret-126)
                                                      )
                                                      (call %init_peer_id% ("op" "concat_strings") [ret-125 ret-126] ret-127)
                                                     )
                                                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-127] ret-128)
                                                    )
                                                   )
                                                  )
                                                  (seq
                                                   (ap :error: -if-error-)
                                                   (xor
                                                    (match :error:.$.error_code 10001
                                                     (null)
                                                    )
                                                    (fail -if-error-)
                                                   )
                                                  )
                                                 )
                                                )
                                               )
                                               (call %init_peer_id% ("chain_connector" "hex_sub") [log-16-0.$.block_number 1] ret-129)
                                              )
                                              (xor
                                               (match ret-129.$.success true
                                                (ap false not-11)
                                               )
                                               (ap true not-11)
                                              )
                                             )
                                             (new -if-error-
                                              (xor
                                               (match not-11 true
                                                (seq
                                                 (seq
                                                  (seq
                                                   (new $array-inline-37
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (ap "hex_sub failed" $array-inline-37)
                                                       (ap log-16-0.$.block_number $array-inline-37)
                                                      )
                                                      (ap 1 $array-inline-37)
                                                     )
                                                     (canon %init_peer_id% $array-inline-37  #array-inline-37-0)
                                                    )
                                                   )
                                                   (par
                                                    (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-37-0])
                                                    (null)
                                                   )
                                                  )
                                                  (call %init_peer_id% ("json" "stringify") [#array-inline-37-0] ret-130)
                                                 )
                                                 (call %init_peer_id% (-spell_id-arg- "store_log") [ret-130] ret-131)
                                                )
                                               )
                                               (seq
                                                (ap :error: -if-error-)
                                                (xor
                                                 (match :error:.$.error_code 10001
                                                  (null)
                                                 )
                                                 (fail -if-error-)
                                                )
                                               )
                                              )
                                             )
                                            )
                                            (ap ret-129.$.diff ret-129_flat)
                                           )
                                           (new -if-error-
                                            (xor
                                             (mismatch ret-129_flat []
                                              (seq
                                               (seq
                                                (new $result-7
                                                 (seq
                                                  (seq
                                                   (seq
                                                    (call %init_peer_id% ("chain_connector" "hex_cmp") [ret-129_flat.$.[0] -left-flat-0.$.[0]] ret-132)
                                                    (new -if-else-error-
                                                     (new -else-error-
                                                      (new -if-error-
                                                       (xor
                                                        (match ret-132.$.success true
                                                         (seq
                                                          (call %init_peer_id% ("cmp" "gt") [ret-132.$.ordering 0] gt)
                                                          (ap gt $result-7)
                                                         )
                                                        )
                                                        (seq
                                                         (ap :error: -if-error-)
                                                         (xor
                                                          (match :error:.$.error_code 10001
                                                           (seq
                                                            (seq
                                                             (seq
                                                              (new $array-inline-38
                                                               (seq
                                                                (seq
                                                                 (ap "hex_cmp error" $array-inline-38)
                                                                 (ap ret-132.$.error $array-inline-38)
                                                                )
                                                                (canon %init_peer_id% $array-inline-38  #array-inline-38-0)
                                                               )
                                                              )
                                                              (par
                                                               (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-38-0])
                                                               (null)
                                                              )
                                                             )
                                                             (call %init_peer_id% ("json" "stringify") [#array-inline-38-0] ret-133)
                                                            )
                                                            (call %init_peer_id% (-spell_id-arg- "store_log") [ret-133] ret-134)
                                                           )
                                                          )
                                                          (seq
                                                           (seq
                                                            (ap :error: -else-error-)
                                                            (xor
                                                             (match :error:.$.error_code 10001
                                                              (ap -if-error- -if-else-error-)
                                                             )
                                                             (ap -else-error- -if-else-error-)
                                                            )
                                                           )
                                                           (fail -if-else-error-)
                                                          )
                                                         )
                                                        )
                                                       )
                                                      )
                                                     )
                                                    )
                                                   )
                                                   (canon %init_peer_id% $result-7  #-result-fix-0-2)
                                                  )
                                                  (ap #-result-fix-0-2 -result-flat-0-2)
                                                 )
                                                )
                                                (new $array-inline-39
                                                 (seq
                                                  (ap true $array-inline-39)
                                                  (canon %init_peer_id% $array-inline-39  #array-inline-39-0)
                                                 )
                                                )
                                               )
                                               (new -if-error-
                                                (xor
                                                 (match -result-flat-0-2 #array-inline-39-0
                                                  (seq
                                                   (seq
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (seq
                                                          (new $array-inline-40
                                                           (seq
                                                            (seq
                                                             (ap "gt_set: will set last seen to" $array-inline-40)
                                                             (ap ret-129_flat.$.[0] $array-inline-40)
                                                            )
                                                            (canon %init_peer_id% $array-inline-40  #array-inline-40-0)
                                                           )
                                                          )
                                                          (par
                                                           (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-40-0])
                                                           (null)
                                                          )
                                                         )
                                                         (call %init_peer_id% ("json" "stringify") [#array-inline-40-0] ret-135)
                                                        )
                                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-135] ret-136)
                                                       )
                                                       (new $array-inline-41
                                                        (seq
                                                         (seq
                                                          (ap "will set last seen to" $array-inline-41)
                                                          (ap ret-129_flat.$.[0] $array-inline-41)
                                                         )
                                                         (canon %init_peer_id% $array-inline-41  #array-inline-41-0)
                                                        )
                                                       )
                                                      )
                                                      (par
                                                       (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-41-0])
                                                       (null)
                                                      )
                                                     )
                                                     (call %init_peer_id% ("json" "stringify") [#array-inline-41-0] ret-137)
                                                    )
                                                    (call %init_peer_id% (-spell_id-arg- "store_log") [ret-137] ret-138)
                                                   )
                                                   (xor
                                                    (seq
                                                     (call %init_peer_id% (-spell_id-arg- "set_string") ["last_seen_block" ret-129_flat.$.[0]] ret-139)
                                                     (new -if-else-error-
                                                      (new -else-error-
                                                       (new -if-error-
                                                        (xor
                                                         (match ret-139.$.success true
                                                          (seq
                                                           (seq
                                                            (seq
                                                             (new $array-inline-42
                                                              (seq
                                                               (seq
                                                                (ap "saved last seen" $array-inline-42)
                                                                (ap ret-129_flat.$.[0] $array-inline-42)
                                                               )
                                                               (canon %init_peer_id% $array-inline-42  #array-inline-42-0)
                                                              )
                                                             )
                                                             (par
                                                              (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-42-0])
                                                              (null)
                                                             )
                                                            )
                                                            (call %init_peer_id% ("json" "stringify") [#array-inline-42-0] ret-140)
                                                           )
                                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-140] ret-141)
                                                          )
                                                         )
                                                         (seq
                                                          (ap :error: -if-error-)
                                                          (xor
                                                           (match :error:.$.error_code 10001
                                                            (seq
                                                             (seq
                                                              (seq
                                                               (new $array-inline-43
                                                                (seq
                                                                 (seq
                                                                  (ap "error saving last_seen_block" $array-inline-43)
                                                                  (ap ret-139.$.error $array-inline-43)
                                                                 )
                                                                 (canon %init_peer_id% $array-inline-43  #array-inline-43-0)
                                                                )
                                                               )
                                                               (par
                                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-43-0])
                                                                (null)
                                                               )
                                                              )
                                                              (call %init_peer_id% ("json" "stringify") [#array-inline-43-0] ret-142)
                                                             )
                                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-142] ret-143)
                                                            )
                                                           )
                                                           (seq
                                                            (seq
                                                             (ap :error: -else-error-)
                                                             (xor
                                                              (match :error:.$.error_code 10001
                                                               (ap -if-error- -if-else-error-)
                                                              )
                                                              (ap -else-error- -if-else-error-)
                                                             )
                                                            )
                                                            (fail -if-else-error-)
                                                           )
                                                          )
                                                         )
                                                        )
                                                       )
                                                      )
                                                     )
                                                    )
                                                    (seq
                                                     (seq
                                                      (seq
                                                       (new $array-inline-44
                                                        (seq
                                                         (seq
                                                          (ap "error saving last_seen_block" $array-inline-44)
                                                          (ap :error: $array-inline-44)
                                                         )
                                                         (canon %init_peer_id% $array-inline-44  #array-inline-44-0)
                                                        )
                                                       )
                                                       (par
                                                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-44-0])
                                                        (null)
                                                       )
                                                      )
                                                      (call %init_peer_id% ("json" "stringify") [#array-inline-44-0] ret-144)
                                                     )
                                                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-144] ret-145)
                                                    )
                                                   )
                                                  )
                                                 )
                                                 (seq
                                                  (ap :error: -if-error-)
                                                  (xor
                                                   (match :error:.$.error_code 10001
                                                    (null)
                                                   )
                                                   (fail -if-error-)
                                                  )
                                                 )
                                                )
                                               )
                                              )
                                             )
                                             (seq
                                              (ap :error: -if-error-)
                                              (xor
                                               (match :error:.$.error_code 10002
                                                (null)
                                               )
                                               (fail -if-error-)
                                              )
                                             )
                                            )
                                           )
                                          )
                                         )
                                         (seq
                                          (seq
                                           (ap :error: -else-error-)
                                           (xor
                                            (match :error:.$.error_code 10001
                                             (ap -if-error- -if-else-error-)
                                            )
                                            (ap -else-error- -if-else-error-)
                                           )
                                          )
                                          (fail -if-else-error-)
                                         )
                                        )
                                       )
                                      )
                                     )
                                    )
                                   )
                                  )
                                  (next log-16-0)
                                 )
                                 (null)
                                )
                               )
                               (new $array-inline-45
                                (seq
                                 (seq
                                  (seq
                                   (ap "poll_new_deals call Hex.min" $array-inline-45)
                                   (ap -latest-flat-0.$.[0] $array-inline-45)
                                  )
                                  (ap -poll-flat-0.$.[0].right_boundary $array-inline-45)
                                 )
                                 (canon %init_peer_id% $array-inline-45  #array-inline-45-0)
                                )
                               )
                              )
                              (par
                               (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-45-0])
                               (null)
                              )
                             )
                             (call %init_peer_id% ("json" "stringify") [#array-inline-45-0] ret-146)
                            )
                            (call %init_peer_id% (-spell_id-arg- "store_log") [ret-146] ret-147)
                           )
                           (call %init_peer_id% ("chain_connector" "hex_min") [-latest-flat-0.$.[0] -poll-flat-0.$.[0].right_boundary] ret-148)
                          )
                          (xor
                           (match ret-148.$.success true
                            (ap false not-12)
                           )
                           (ap true not-12)
                          )
                         )
                         (new -if-error-
                          (xor
                           (match not-12 true
                            (seq
                             (seq
                              (seq
                               (new $array-inline-46
                                (seq
                                 (seq
                                  (seq
                                   (ap "hex_min failed" $array-inline-46)
                                   (ap -latest-flat-0.$.[0] $array-inline-46)
                                  )
                                  (ap -poll-flat-0.$.[0].right_boundary $array-inline-46)
                                 )
                                 (canon %init_peer_id% $array-inline-46  #array-inline-46-0)
                                )
                               )
                               (par
                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-46-0])
                                (null)
                               )
                              )
                              (call %init_peer_id% ("json" "stringify") [#array-inline-46-0] ret-149)
                             )
                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-149] ret-150)
                            )
                           )
                           (seq
                            (ap :error: -if-error-)
                            (xor
                             (match :error:.$.error_code 10001
                              (null)
                             )
                             (fail -if-error-)
                            )
                           )
                          )
                         )
                        )
                        (ap ret-148.$.hex ret-148_flat)
                       )
                       (new -if-error-
                        (xor
                         (mismatch ret-148_flat []
                          (seq
                           (new $result-8
                            (seq
                             (seq
                              (seq
                               (seq
                                (call %init_peer_id% (-spell_id-arg- "get_string") ["last_seen_block"] ret-151)
                                (xor
                                 (match ret-151.$.success true
                                  (ap false not-13)
                                 )
                                 (ap true not-13)
                                )
                               )
                               (new -if-else-error-
                                (new -else-error-
                                 (new -if-error-
                                  (xor
                                   (match not-13 true
                                    (seq
                                     (seq
                                      (seq
                                       (new $array-inline-47
                                        (seq
                                         (seq
                                          (seq
                                           (ap "get_string failed" $array-inline-47)
                                           (ap "last_seen_block" $array-inline-47)
                                          )
                                          (ap ret-151.$.error $array-inline-47)
                                         )
                                         (canon %init_peer_id% $array-inline-47  #array-inline-47-0)
                                        )
                                       )
                                       (par
                                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-47-0])
                                        (null)
                                       )
                                      )
                                      (call %init_peer_id% ("json" "stringify") [#array-inline-47-0] ret-152)
                                     )
                                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-152] ret-153)
                                    )
                                   )
                                   (seq
                                    (ap :error: -if-error-)
                                    (xor
                                     (match :error:.$.error_code 10001
                                      (seq
                                       (xor
                                        (match ret-151.$.absent true
                                         (ap false not-14)
                                        )
                                        (ap true not-14)
                                       )
                                       (new -if-error-
                                        (xor
                                         (match not-14 true
                                          (ap ret-151.$.str $result-8)
                                         )
                                         (seq
                                          (ap :error: -if-error-)
                                          (xor
                                           (match :error:.$.error_code 10001
                                            (null)
                                           )
                                           (fail -if-error-)
                                          )
                                         )
                                        )
                                       )
                                      )
                                     )
                                     (seq
                                      (seq
                                       (ap :error: -else-error-)
                                       (xor
                                        (match :error:.$.error_code 10001
                                         (ap -if-error- -if-else-error-)
                                        )
                                        (ap -else-error- -if-else-error-)
                                       )
                                      )
                                      (fail -if-else-error-)
                                     )
                                    )
                                   )
                                  )
                                 )
                                )
                               )
                              )
                              (canon %init_peer_id% $result-8  #-result-fix-0-3)
                             )
                             (ap #-result-fix-0-3 -result-flat-0-3)
                            )
                           )
                           (new -if-else-error-
                            (new -else-error-
                             (new -if-error-
                              (xor
                               (mismatch -result-flat-0-3 []
                                (seq
                                 (seq
                                  (new $result-9
                                   (seq
                                    (seq
                                     (seq
                                      (call %init_peer_id% ("chain_connector" "hex_cmp") [ret-148_flat.$.[0] -result-flat-0-3.$.[0]] ret-154)
                                      (new -if-else-error-
                                       (new -else-error-
                                        (new -if-error-
                                         (xor
                                          (match ret-154.$.success true
                                           (seq
                                            (call %init_peer_id% ("cmp" "gt") [ret-154.$.ordering 0] gt-0)
                                            (ap gt-0 $result-9)
                                           )
                                          )
                                          (seq
                                           (ap :error: -if-error-)
                                           (xor
                                            (match :error:.$.error_code 10001
                                             (seq
                                              (seq
                                               (seq
                                                (new $array-inline-48
                                                 (seq
                                                  (seq
                                                   (ap "hex_cmp error" $array-inline-48)
                                                   (ap ret-154.$.error $array-inline-48)
                                                  )
                                                  (canon %init_peer_id% $array-inline-48  #array-inline-48-0)
                                                 )
                                                )
                                                (par
                                                 (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-48-0])
                                                 (null)
                                                )
                                               )
                                               (call %init_peer_id% ("json" "stringify") [#array-inline-48-0] ret-155)
                                              )
                                              (call %init_peer_id% (-spell_id-arg- "store_log") [ret-155] ret-156)
                                             )
                                            )
                                            (seq
                                             (seq
                                              (ap :error: -else-error-)
                                              (xor
                                               (match :error:.$.error_code 10001
                                                (ap -if-error- -if-else-error-)
                                               )
                                               (ap -else-error- -if-else-error-)
                                              )
                                             )
                                             (fail -if-else-error-)
                                            )
                                           )
                                          )
                                         )
                                        )
                                       )
                                      )
                                     )
                                     (canon %init_peer_id% $result-9  #-result-fix-0-4)
                                    )
                                    (ap #-result-fix-0-4 -result-flat-0-4)
                                   )
                                  )
                                  (new $array-inline-49
                                   (seq
                                    (ap true $array-inline-49)
                                    (canon %init_peer_id% $array-inline-49  #array-inline-49-0)
                                   )
                                  )
                                 )
                                 (new -if-error-
                                  (xor
                                   (match -result-flat-0-4 #array-inline-49-0
                                    (seq
                                     (seq
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (new $array-inline-50
                                             (seq
                                              (seq
                                               (ap "gt_set: will set last seen to" $array-inline-50)
                                               (ap ret-148_flat.$.[0] $array-inline-50)
                                              )
                                              (canon %init_peer_id% $array-inline-50  #array-inline-50-0)
                                             )
                                            )
                                            (par
                                             (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-50-0])
                                             (null)
                                            )
                                           )
                                           (call %init_peer_id% ("json" "stringify") [#array-inline-50-0] ret-157)
                                          )
                                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-157] ret-158)
                                         )
                                         (new $array-inline-51
                                          (seq
                                           (seq
                                            (ap "will set last seen to" $array-inline-51)
                                            (ap ret-148_flat.$.[0] $array-inline-51)
                                           )
                                           (canon %init_peer_id% $array-inline-51  #array-inline-51-0)
                                          )
                                         )
                                        )
                                        (par
                                         (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-51-0])
                                         (null)
                                        )
                                       )
                                       (call %init_peer_id% ("json" "stringify") [#array-inline-51-0] ret-159)
                                      )
                                      (call %init_peer_id% (-spell_id-arg- "store_log") [ret-159] ret-160)
                                     )
                                     (xor
                                      (seq
                                       (call %init_peer_id% (-spell_id-arg- "set_string") ["last_seen_block" ret-148_flat.$.[0]] ret-161)
                                       (new -if-else-error-
                                        (new -else-error-
                                         (new -if-error-
                                          (xor
                                           (match ret-161.$.success true
                                            (seq
                                             (seq
                                              (seq
                                               (new $array-inline-52
                                                (seq
                                                 (seq
                                                  (ap "saved last seen" $array-inline-52)
                                                  (ap ret-148_flat.$.[0] $array-inline-52)
                                                 )
                                                 (canon %init_peer_id% $array-inline-52  #array-inline-52-0)
                                                )
                                               )
                                               (par
                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-52-0])
                                                (null)
                                               )
                                              )
                                              (call %init_peer_id% ("json" "stringify") [#array-inline-52-0] ret-162)
                                             )
                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-162] ret-163)
                                            )
                                           )
                                           (seq
                                            (ap :error: -if-error-)
                                            (xor
                                             (match :error:.$.error_code 10001
                                              (seq
                                               (seq
                                                (seq
                                                 (new $array-inline-53
                                                  (seq
                                                   (seq
                                                    (ap "error saving last_seen_block" $array-inline-53)
                                                    (ap ret-161.$.error $array-inline-53)
                                                   )
                                                   (canon %init_peer_id% $array-inline-53  #array-inline-53-0)
                                                  )
                                                 )
                                                 (par
                                                  (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-53-0])
                                                  (null)
                                                 )
                                                )
                                                (call %init_peer_id% ("json" "stringify") [#array-inline-53-0] ret-164)
                                               )
                                               (call %init_peer_id% (-spell_id-arg- "store_log") [ret-164] ret-165)
                                              )
                                             )
                                             (seq
                                              (seq
                                               (ap :error: -else-error-)
                                               (xor
                                                (match :error:.$.error_code 10001
                                                 (ap -if-error- -if-else-error-)
                                                )
                                                (ap -else-error- -if-else-error-)
                                               )
                                              )
                                              (fail -if-else-error-)
                                             )
                                            )
                                           )
                                          )
                                         )
                                        )
                                       )
                                      )
                                      (seq
                                       (seq
                                        (seq
                                         (new $array-inline-54
                                          (seq
                                           (seq
                                            (ap "error saving last_seen_block" $array-inline-54)
                                            (ap :error: $array-inline-54)
                                           )
                                           (canon %init_peer_id% $array-inline-54  #array-inline-54-0)
                                          )
                                         )
                                         (par
                                          (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-54-0])
                                          (null)
                                         )
                                        )
                                        (call %init_peer_id% ("json" "stringify") [#array-inline-54-0] ret-166)
                                       )
                                       (call %init_peer_id% (-spell_id-arg- "store_log") [ret-166] ret-167)
                                      )
                                     )
                                    )
                                   )
                                   (seq
                                    (ap :error: -if-error-)
                                    (xor
                                     (match :error:.$.error_code 10001
                                      (null)
                                     )
                                     (fail -if-error-)
                                    )
                                   )
                                  )
                                 )
                                )
                               )
                               (seq
                                (ap :error: -if-error-)
                                (xor
                                 (match :error:.$.error_code 10002
                                  (seq
                                   (seq
                                    (seq
                                     (seq
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (new $array-inline-55
                                           (seq
                                            (seq
                                             (ap "increase: will set last seen to" $array-inline-55)
                                             (ap ret-148_flat.$.[0] $array-inline-55)
                                            )
                                            (canon %init_peer_id% $array-inline-55  #array-inline-55-0)
                                           )
                                          )
                                          (par
                                           (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-55-0])
                                           (null)
                                          )
                                         )
                                         (call %init_peer_id% ("json" "stringify") [#array-inline-55-0] ret-168)
                                        )
                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-168] ret-169)
                                       )
                                       (new $array-inline-56
                                        (seq
                                         (seq
                                          (ap "will set last seen to" $array-inline-56)
                                          (ap ret-148_flat.$.[0] $array-inline-56)
                                         )
                                         (canon %init_peer_id% $array-inline-56  #array-inline-56-0)
                                        )
                                       )
                                      )
                                      (par
                                       (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-56-0])
                                       (null)
                                      )
                                     )
                                     (call %init_peer_id% ("json" "stringify") [#array-inline-56-0] ret-170)
                                    )
                                    (call %init_peer_id% (-spell_id-arg- "store_log") [ret-170] ret-171)
                                   )
                                   (xor
                                    (seq
                                     (call %init_peer_id% (-spell_id-arg- "set_string") ["last_seen_block" ret-148_flat.$.[0]] ret-172)
                                     (new -if-else-error-
                                      (new -else-error-
                                       (new -if-error-
                                        (xor
                                         (match ret-172.$.success true
                                          (seq
                                           (seq
                                            (seq
                                             (new $array-inline-57
                                              (seq
                                               (seq
                                                (ap "saved last seen" $array-inline-57)
                                                (ap ret-148_flat.$.[0] $array-inline-57)
                                               )
                                               (canon %init_peer_id% $array-inline-57  #array-inline-57-0)
                                              )
                                             )
                                             (par
                                              (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-57-0])
                                              (null)
                                             )
                                            )
                                            (call %init_peer_id% ("json" "stringify") [#array-inline-57-0] ret-173)
                                           )
                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-173] ret-174)
                                          )
                                         )
                                         (seq
                                          (ap :error: -if-error-)
                                          (xor
                                           (match :error:.$.error_code 10001
                                            (seq
                                             (seq
                                              (seq
                                               (new $array-inline-58
                                                (seq
                                                 (seq
                                                  (ap "error saving last_seen_block" $array-inline-58)
                                                  (ap ret-172.$.error $array-inline-58)
                                                 )
                                                 (canon %init_peer_id% $array-inline-58  #array-inline-58-0)
                                                )
                                               )
                                               (par
                                                (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-58-0])
                                                (null)
                                               )
                                              )
                                              (call %init_peer_id% ("json" "stringify") [#array-inline-58-0] ret-175)
                                             )
                                             (call %init_peer_id% (-spell_id-arg- "store_log") [ret-175] ret-176)
                                            )
                                           )
                                           (seq
                                            (seq
                                             (ap :error: -else-error-)
                                             (xor
                                              (match :error:.$.error_code 10001
                                               (ap -if-error- -if-else-error-)
                                              )
                                              (ap -else-error- -if-else-error-)
                                             )
                                            )
                                            (fail -if-else-error-)
                                           )
                                          )
                                         )
                                        )
                                       )
                                      )
                                     )
                                    )
                                    (seq
                                     (seq
                                      (seq
                                       (new $array-inline-59
                                        (seq
                                         (seq
                                          (ap "error saving last_seen_block" $array-inline-59)
                                          (ap :error: $array-inline-59)
                                         )
                                         (canon %init_peer_id% $array-inline-59  #array-inline-59-0)
                                        )
                                       )
                                       (par
                                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-59-0])
                                        (null)
                                       )
                                      )
                                      (call %init_peer_id% ("json" "stringify") [#array-inline-59-0] ret-177)
                                     )
                                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-177] ret-178)
                                    )
                                   )
                                  )
                                 )
                                 (seq
                                  (seq
                                   (ap :error: -else-error-)
                                   (xor
                                    (match :error:.$.error_code 10001
                                     (ap -if-error- -if-else-error-)
                                    )
                                    (ap -else-error- -if-else-error-)
                                   )
                                  )
                                  (fail -if-else-error-)
                                 )
                                )
                               )
                              )
                             )
                            )
                           )
                          )
                         )
                         (seq
                          (ap :error: -if-error-)
                          (xor
                           (match :error:.$.error_code 10002
                            (null)
                           )
                           (fail -if-error-)
                          )
                         )
                        )
                       )
                      )
                     )
                     (seq
                      (ap :error: -if-error-)
                      (xor
                       (match :error:.$.error_code 10002
                        (null)
                       )
                       (fail -if-error-)
                      )
                     )
                    )
                   )
                  )
                 )
                 (seq
                  (ap :error: -if-error-)
                  (xor
                   (match :error:.$.error_code 10002
                    (seq
                     (seq
                      (seq
                       (new $array-inline-60
                        (seq
                         (ap "get_left_boundary returns nil, unable to proceed" $array-inline-60)
                         (canon %init_peer_id% $array-inline-60  #array-inline-60-0)
                        )
                       )
                       (par
                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-60-0])
                        (null)
                       )
                      )
                      (call %init_peer_id% ("json" "stringify") [#array-inline-60-0] ret-179)
                     )
                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-179] ret-180)
                    )
                   )
                   (seq
                    (seq
                     (ap :error: -else-error-)
                     (xor
                      (match :error:.$.error_code 10001
                       (ap -if-error- -if-else-error-)
                      )
                      (ap -else-error- -if-else-error-)
                     )
                    )
                    (fail -if-else-error-)
                   )
                  )
                 )
                )
               )
              )
             )
            )
            (null)
           )
          )
          (xor
           (seq
            (new $changes-0
             (seq
              (seq
               (seq
                (seq
                 (seq
                  (new $requests
                   (seq
                    (seq
                     (new -if-error-
                      (xor
                       (mismatch -joined_deals-flat-0 []
                        (new $deal_updates
                         (fold -joined_deals-flat-0 joined_deal-0
                          (seq
                           (seq
                            (seq
                             (ap joined_deal-0.$.deal_id joined_deal-0_flat)
                             (new $state-0
                              (seq
                               (seq
                                (seq
                                 (seq
                                  (call %init_peer_id% (-spell_id-arg- "get_string") [joined_deal-0_flat] ret-181)
                                  (xor
                                   (match ret-181.$.success false
                                    (ap ret-181.$.success and)
                                   )
                                   (seq
                                    (xor
                                     (match ret-181.$.absent true
                                      (ap false not-15)
                                     )
                                     (ap true not-15)
                                    )
                                    (ap not-15 and)
                                   )
                                  )
                                 )
                                 (new -if-else-error-
                                  (new -else-error-
                                   (new -if-error-
                                    (xor
                                     (match and true
                                      (xor
                                       (seq
                                        (call %init_peer_id% ("json" "parse") [ret-181.$.str] ret-182)
                                        (ap ret-182 $state-0)
                                       )
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (new $array-inline-61
                                             (seq
                                              (seq
                                               (ap "failed to parse deal state from json" $array-inline-61)
                                               (ap :error: $array-inline-61)
                                              )
                                              (canon %init_peer_id% $array-inline-61  #array-inline-61-0)
                                             )
                                            )
                                            (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" joined_deal-0_flat ": "] ret-183)
                                           )
                                           (par
                                            (call %init_peer_id% ("run-console" "print") [ret-183 #array-inline-61-0])
                                            (null)
                                           )
                                          )
                                          (call %init_peer_id% ("json" "stringify") [#array-inline-61-0] ret-184)
                                         )
                                         (call %init_peer_id% ("op" "concat_strings") [ret-183 ret-184] ret-185)
                                        )
                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-185] ret-186)
                                       )
                                      )
                                     )
                                     (seq
                                      (ap :error: -if-error-)
                                      (xor
                                       (match :error:.$.error_code 10001
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (seq
                                             (new $array-inline-62
                                              (seq
                                               (seq
                                                (ap "deal state not found:" $array-inline-62)
                                                (ap ret-181.$.error $array-inline-62)
                                               )
                                               (canon %init_peer_id% $array-inline-62  #array-inline-62-0)
                                              )
                                             )
                                             (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" joined_deal-0_flat ": "] ret-187)
                                            )
                                            (par
                                             (call %init_peer_id% ("run-console" "print") [ret-187 #array-inline-62-0])
                                             (null)
                                            )
                                           )
                                           (call %init_peer_id% ("json" "stringify") [#array-inline-62-0] ret-188)
                                          )
                                          (call %init_peer_id% ("op" "concat_strings") [ret-187 ret-188] ret-189)
                                         )
                                         (call %init_peer_id% (-spell_id-arg- "store_log") [ret-189] ret-190)
                                        )
                                       )
                                       (seq
                                        (seq
                                         (ap :error: -else-error-)
                                         (xor
                                          (match :error:.$.error_code 10001
                                           (ap -if-error- -if-else-error-)
                                          )
                                          (ap -else-error- -if-else-error-)
                                         )
                                        )
                                        (fail -if-else-error-)
                                       )
                                      )
                                     )
                                    )
                                   )
                                  )
                                 )
                                )
                                (canon %init_peer_id% $state-0  #-state-fix-0)
                               )
                               (ap #-state-fix-0 -state-flat-0)
                              )
                             )
                            )
                            (new -if-error-
                             (xor
                              (mismatch -state-flat-0 []
                               (seq
                                (seq
                                 (new %DealInfo_obj_map
                                  (seq
                                   (seq
                                    (ap ("deal_id" joined_deal-0_flat) %DealInfo_obj_map)
                                    (ap ("worker_id" joined_deal-0.$.worker_id) %DealInfo_obj_map)
                                   )
                                   (canon %init_peer_id% %DealInfo_obj_map  DealInfo_obj)
                                  )
                                 )
                                 (new %DealChangesReq_obj_map
                                  (seq
                                   (seq
                                    (ap ("deal_info" DealInfo_obj) %DealChangesReq_obj_map)
                                    (ap ("left_boundary" -state-flat-0.$.[0].left_boundary) %DealChangesReq_obj_map)
                                   )
                                   (canon %init_peer_id% %DealChangesReq_obj_map  DealChangesReq_obj)
                                  )
                                 )
                                )
                                (ap DealChangesReq_obj $requests)
                               )
                              )
                              (seq
                               (ap :error: -if-error-)
                               (xor
                                (match :error:.$.error_code 10002
                                 (null)
                                )
                                (fail -if-error-)
                               )
                              )
                             )
                            )
                           )
                           (next joined_deal-0)
                          )
                          (null)
                         )
                        )
                       )
                       (seq
                        (ap :error: -if-error-)
                        (xor
                         (match :error:.$.error_code 10002
                          (null)
                         )
                         (fail -if-error-)
                        )
                       )
                      )
                     )
                     (canon %init_peer_id% $requests  #-requests-fix-0)
                    )
                    (ap #-requests-fix-0 -requests-flat-0)
                   )
                  )
                  (ap -requests-flat-0 -requests-flat-0_to_functor)
                 )
                 (ap -requests-flat-0_to_functor.length -requests-flat-0_length)
                )
                (new -if-error-
                 (xor
                  (mismatch -requests-flat-0_length 0
                   (seq
                    (seq
                     (seq
                      (seq
                       (seq
                        (new $array-inline-63
                         (seq
                          (seq
                           (seq
                            (seq
                             (seq
                              (ap -requests-flat-0 -requests-flat-0_to_functor-0)
                              (ap -requests-flat-0_to_functor-0.length -requests-flat-0_length-0)
                             )
                             (ap "try to find updates for" $array-inline-63)
                            )
                            (ap -requests-flat-0_length-0 $array-inline-63)
                           )
                           (ap "deals" $array-inline-63)
                          )
                          (canon %init_peer_id% $array-inline-63  #array-inline-63-0)
                         )
                        )
                        (par
                         (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-63-0])
                         (null)
                        )
                       )
                       (call %init_peer_id% ("json" "stringify") [#array-inline-63-0] ret-191)
                      )
                      (call %init_peer_id% (-spell_id-arg- "store_log") [ret-191] ret-192)
                     )
                     (call %init_peer_id% ("chain_connector" "poll_deal_changes") [-chain-arg-.$.api_endpoint -requests-flat-0] ret-193)
                    )
                    (new -if-else-error-
                     (new -else-error-
                      (new -if-error-
                       (xor
                        (match ret-193.$.success true
                         (ap ret-193.$.changes $changes-0)
                        )
                        (seq
                         (ap :error: -if-error-)
                         (xor
                          (match :error:.$.error_code 10001
                           (seq
                            (seq
                             (seq
                              (new $array-inline-64
                               (seq
                                (seq
                                 (ap "error retrieving deal changes from chain" $array-inline-64)
                                 (ap ret-193.$.error.[0] $array-inline-64)
                                )
                                (canon %init_peer_id% $array-inline-64  #array-inline-64-0)
                               )
                              )
                              (par
                               (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-64-0])
                               (null)
                              )
                             )
                             (call %init_peer_id% ("json" "stringify") [#array-inline-64-0] ret-194)
                            )
                            (call %init_peer_id% (-spell_id-arg- "store_log") [ret-194] ret-195)
                           )
                          )
                          (seq
                           (seq
                            (ap :error: -else-error-)
                            (xor
                             (match :error:.$.error_code 10001
                              (ap -if-error- -if-else-error-)
                             )
                             (ap -else-error- -if-else-error-)
                            )
                           )
                           (fail -if-else-error-)
                          )
                         )
                        )
                       )
                      )
                     )
                    )
                   )
                  )
                  (seq
                   (ap :error: -if-error-)
                   (xor
                    (match :error:.$.error_code 10002
                     (null)
                    )
                    (fail -if-error-)
                   )
                  )
                 )
                )
               )
               (canon %init_peer_id% $changes-0  #-changes-fix-0)
              )
              (ap #-changes-fix-0 -changes-flat-0)
             )
            )
            (new -if-error-
             (xor
              (mismatch -changes-flat-0 []
               (seq
                (fold -changes-flat-0.$.[0] change-0
                 (seq
                  (seq
                   (seq
                    (ap change-0.$.deal_info change-0_flat)
                    (ap change-0_flat.$.deal_id change-0_flat_flat)
                   )
                   (new -if-else-error-
                    (new -else-error-
                     (new -if-error-
                      (xor
                       (match change-0.$.success true
                        (new -if-error-
                         (xor
                          (mismatch change-0.$.log []
                           (seq
                            (seq
                             (seq
                              (seq
                               (seq
                                (seq
                                 (seq
                                  (seq
                                   (seq
                                    (seq
                                     (seq
                                      (seq
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (seq
                                             (seq
                                              (seq
                                               (new $array-inline-65
                                                (seq
                                                 (seq
                                                  (ap "found a deal changed log on block" $array-inline-65)
                                                  (ap change-0.$.log.[0].block_number $array-inline-65)
                                                 )
                                                 (canon %init_peer_id% $array-inline-65  #array-inline-65-0)
                                                )
                                               )
                                               (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" change-0_flat_flat ": "] ret-196)
                                              )
                                              (par
                                               (call %init_peer_id% ("run-console" "print") [ret-196 #array-inline-65-0])
                                               (null)
                                              )
                                             )
                                             (call %init_peer_id% ("json" "stringify") [#array-inline-65-0] ret-197)
                                            )
                                            (call %init_peer_id% ("op" "concat_strings") [ret-196 ret-197] ret-198)
                                           )
                                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-198] ret-199)
                                          )
                                          (ap change-0.$.deal_info.deal_id change-0_flat-0)
                                         )
                                         (ap change-0.$.deal_info.worker_id change-0_flat-1)
                                        )
                                        (call %init_peer_id% ("json" "stringify") [change-0.$.log.[0].info.app_cid] ret-200)
                                       )
                                       (new $array-inline-66
                                        (seq
                                         (seq
                                          (seq
                                           (ap "sending the latest update to the worker" $array-inline-66)
                                           (ap change-0_flat-1 $array-inline-66)
                                          )
                                          (ap ret-200 $array-inline-66)
                                         )
                                         (canon %init_peer_id% $array-inline-66  #array-inline-66-0)
                                        )
                                       )
                                      )
                                      (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" change-0_flat-0 ": "] ret-201)
                                     )
                                     (par
                                      (call %init_peer_id% ("run-console" "print") [ret-201 #array-inline-66-0])
                                      (null)
                                     )
                                    )
                                    (call %init_peer_id% ("json" "stringify") [#array-inline-66-0] ret-202)
                                   )
                                   (call %init_peer_id% ("op" "concat_strings") [ret-201 ret-202] ret-203)
                                  )
                                  (call %init_peer_id% (-spell_id-arg- "store_log") [ret-203] ret-204)
                                 )
                                 (xor
                                  (seq
                                   (seq
                                    (new $-ephemeral-stream-
                                     (new #-ephemeral-canon-
                                      (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                     )
                                    )
                                    (call change-0_flat-1 ("worker-spell" "set_string") ["worker_def_cid" ret-200] ret-205)
                                   )
                                   (new $-ephemeral-stream-
                                    (new #-ephemeral-canon-
                                     (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                    )
                                   )
                                  )
                                  (seq
                                   (seq
                                    (new $-ephemeral-stream-
                                     (new #-ephemeral-canon-
                                      (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                     )
                                    )
                                    (new $-ephemeral-stream-
                                     (new #-ephemeral-canon-
                                      (canon %init_peer_id% $-ephemeral-stream-  #-ephemeral-canon-)
                                     )
                                    )
                                   )
                                   (fail :error:)
                                  )
                                 )
                                )
                                (ap change-0.$.log change-0_flat-2)
                               )
                               (ap change-0_flat-2.$.[0].block_number change-0_flat-2_flat)
                              )
                              (new %DealState_obj-0_map
                               (seq
                                (ap ("left_boundary" change-0_flat-2_flat) %DealState_obj-0_map)
                                (canon %init_peer_id% %DealState_obj-0_map  DealState_obj-0)
                               )
                              )
                             )
                             (call %init_peer_id% ("json" "stringify") [DealState_obj-0] ret-206)
                            )
                            (call %init_peer_id% (-spell_id-arg- "set_string") [change-0_flat_flat ret-206] ret-207)
                           )
                          )
                          (seq
                           (ap :error: -if-error-)
                           (xor
                            (match :error:.$.error_code 10002
                             (null)
                            )
                            (fail -if-error-)
                           )
                          )
                         )
                        )
                       )
                       (seq
                        (ap :error: -if-error-)
                        (xor
                         (match :error:.$.error_code 10001
                          (seq
                           (seq
                            (seq
                             (seq
                              (seq
                               (new $array-inline-67
                                (seq
                                 (seq
                                  (ap "error retrieving deal change" $array-inline-67)
                                  (ap change-0.$.error $array-inline-67)
                                 )
                                 (canon %init_peer_id% $array-inline-67  #array-inline-67-0)
                                )
                               )
                               (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" change-0_flat_flat ": "] ret-208)
                              )
                              (par
                               (call %init_peer_id% ("run-console" "print") [ret-208 #array-inline-67-0])
                               (null)
                              )
                             )
                             (call %init_peer_id% ("json" "stringify") [#array-inline-67-0] ret-209)
                            )
                            (call %init_peer_id% ("op" "concat_strings") [ret-208 ret-209] ret-210)
                           )
                           (call %init_peer_id% (-spell_id-arg- "store_log") [ret-210] ret-211)
                          )
                         )
                         (seq
                          (seq
                           (ap :error: -else-error-)
                           (xor
                            (match :error:.$.error_code 10001
                             (ap -if-error- -if-else-error-)
                            )
                            (ap -else-error- -if-else-error-)
                           )
                          )
                          (fail -if-else-error-)
                         )
                        )
                       )
                      )
                     )
                    )
                   )
                  )
                  (next change-0)
                 )
                 (null)
                )
                (par
                 (fold -changes-flat-0.$.[0] change-1
                  (par
                   (seq
                    (seq
                     (seq
                      (seq
                       (seq
                        (seq
                         (ap change-1.$.deal_info change-1_flat)
                         (ap change-1_flat.$.deal_id change-1_flat_flat)
                        )
                        (call %init_peer_id% ("chain_connector" "hex_min") [change-1.$.right_boundary -latest-flat-0.$.[0]] ret-212)
                       )
                       (xor
                        (match ret-212.$.success true
                         (ap false not-16)
                        )
                        (ap true not-16)
                       )
                      )
                      (new -if-error-
                       (xor
                        (match not-16 true
                         (seq
                          (seq
                           (seq
                            (new $array-inline-68
                             (seq
                              (seq
                               (seq
                                (ap "hex_min failed" $array-inline-68)
                                (ap change-1.$.right_boundary $array-inline-68)
                               )
                               (ap -latest-flat-0.$.[0] $array-inline-68)
                              )
                              (canon %init_peer_id% $array-inline-68  #array-inline-68-0)
                             )
                            )
                            (par
                             (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-68-0])
                             (null)
                            )
                           )
                           (call %init_peer_id% ("json" "stringify") [#array-inline-68-0] ret-213)
                          )
                          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-213] ret-214)
                         )
                        )
                        (seq
                         (ap :error: -if-error-)
                         (xor
                          (match :error:.$.error_code 10001
                           (null)
                          )
                          (fail -if-error-)
                         )
                        )
                       )
                      )
                     )
                     (ap ret-212.$.hex ret-212_flat)
                    )
                    (new -if-error-
                     (xor
                      (mismatch ret-212_flat []
                       (seq
                        (seq
                         (seq
                          (seq
                           (call %init_peer_id% ("chain_connector" "hex_add") [ret-212_flat.$.[0] 1] ret-215)
                           (xor
                            (match ret-215.$.success true
                             (ap false not-17)
                            )
                            (ap true not-17)
                           )
                          )
                          (new -if-error-
                           (xor
                            (match not-17 true
                             (seq
                              (seq
                               (seq
                                (new $array-inline-69
                                 (seq
                                  (seq
                                   (seq
                                    (ap "hex_add failed" $array-inline-69)
                                    (ap ret-212_flat.$.[0] $array-inline-69)
                                   )
                                   (ap 1 $array-inline-69)
                                  )
                                  (canon %init_peer_id% $array-inline-69  #array-inline-69-0)
                                 )
                                )
                                (par
                                 (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-69-0])
                                 (null)
                                )
                               )
                               (call %init_peer_id% ("json" "stringify") [#array-inline-69-0] ret-216)
                              )
                              (call %init_peer_id% (-spell_id-arg- "store_log") [ret-216] ret-217)
                             )
                            )
                            (seq
                             (ap :error: -if-error-)
                             (xor
                              (match :error:.$.error_code 10001
                               (null)
                              )
                              (fail -if-error-)
                             )
                            )
                           )
                          )
                         )
                         (ap ret-215.$.hex ret-215_flat)
                        )
                        (new -if-error-
                         (xor
                          (mismatch ret-215_flat []
                           (seq
                            (seq
                             (new %DealState_obj-1_map
                              (seq
                               (ap ("left_boundary" ret-215_flat.$.[0]) %DealState_obj-1_map)
                               (canon %init_peer_id% %DealState_obj-1_map  DealState_obj-1)
                              )
                             )
                             (call %init_peer_id% ("json" "stringify") [DealState_obj-1] ret-218)
                            )
                            (call %init_peer_id% (-spell_id-arg- "set_string") [change-1_flat_flat ret-218] ret-219)
                           )
                          )
                          (seq
                           (ap :error: -if-error-)
                           (xor
                            (match :error:.$.error_code 10002
                             (null)
                            )
                            (fail -if-error-)
                           )
                          )
                         )
                        )
                       )
                      )
                      (seq
                       (ap :error: -if-error-)
                       (xor
                        (match :error:.$.error_code 10002
                         (null)
                        )
                        (fail -if-error-)
                       )
                      )
                     )
                    )
                   )
                   (next change-1)
                  )
                  (never)
                 )
                 (null)
                )
               )
              )
              (seq
               (ap :error: -if-error-)
               (xor
                (match :error:.$.error_code 10002
                 (null)
                )
                (fail -if-error-)
               )
              )
             )
            )
           )
           (null)
          )
         )
         (xor
          (seq
           (seq
            (seq
             (new $known_txs
              (new $unknown_txs
               (seq
                (seq
                 (seq
                  (seq
                   (seq
                    (seq
                     (seq
                      (call %init_peer_id% (-spell_id-arg- "list_get_strings") ["worker_registration_txs"] ret-220)
                      (call %init_peer_id% (-spell_id-arg- "list_get_strings") ["worker_registration_txs_statuses"] ret-221)
                     )
                     (fold ret-221.$.strings status_str-0
                      (seq
                       (xor
                        (seq
                         (seq
                          (call %init_peer_id% ("json" "parse") [status_str-0] ret-222)
                          (call %init_peer_id% ("json" "stringify") [ret-222.$.tx_info] ret-223)
                         )
                         (ap ret-223 $known_txs)
                        )
                        (seq
                         (seq
                          (seq
                           (new $array-inline-70
                            (seq
                             (seq
                              (seq
                               (seq
                                (ap "can't parse worker tx status:" $array-inline-70)
                                (ap status_str-0 $array-inline-70)
                               )
                               (ap "error:" $array-inline-70)
                              )
                              (ap :error: $array-inline-70)
                             )
                             (canon %init_peer_id% $array-inline-70  #array-inline-70-0)
                            )
                           )
                           (par
                            (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-70-0])
                            (null)
                           )
                          )
                          (call %init_peer_id% ("json" "stringify") [#array-inline-70-0] ret-224)
                         )
                         (call %init_peer_id% (-spell_id-arg- "store_log") [ret-224] ret-225)
                        )
                       )
                       (next status_str-0)
                      )
                      (null)
                     )
                    )
                    (canon %init_peer_id% $known_txs  #known_txs_canon)
                   )
                   (call %init_peer_id% ("array" "diff") [ret-220.$.strings #known_txs_canon] ret-226)
                  )
                  (fold ret-226 tx-0
                   (seq
                    (xor
                     (seq
                      (call %init_peer_id% ("json" "parse") [tx-0] ret-227)
                      (ap ret-227 $unknown_txs)
                     )
                     (seq
                      (seq
                       (seq
                        (new $array-inline-71
                         (seq
                          (seq
                           (seq
                            (seq
                             (ap "can't parse worker tx info:" $array-inline-71)
                             (ap tx-0 $array-inline-71)
                            )
                            (ap "error:" $array-inline-71)
                           )
                           (ap :error: $array-inline-71)
                          )
                          (canon %init_peer_id% $array-inline-71  #array-inline-71-0)
                         )
                        )
                        (par
                         (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-71-0])
                         (null)
                        )
                       )
                       (call %init_peer_id% ("json" "stringify") [#array-inline-71-0] ret-228)
                      )
                      (call %init_peer_id% (-spell_id-arg- "store_log") [ret-228] ret-229)
                     )
                    )
                    (next tx-0)
                   )
                   (null)
                  )
                 )
                 (canon %init_peer_id% $unknown_txs  #-unknown_txs-fix-0)
                )
                (ap #-unknown_txs-fix-0 -unknown_txs-flat-0)
               )
              )
             )
             (ap -unknown_txs-flat-0 -unknown_txs-flat-0_to_functor)
            )
            (ap -unknown_txs-flat-0_to_functor.length -unknown_txs-flat-0_length)
           )
           (new -if-error-
            (xor
             (mismatch -unknown_txs-flat-0_length 0
              (seq
               (seq
                (seq
                 (seq
                  (seq
                   (seq
                    (new $array-inline-72
                     (seq
                      (seq
                       (seq
                        (seq
                         (seq
                          (ap -unknown_txs-flat-0 -unknown_txs-flat-0_to_functor-0)
                          (ap -unknown_txs-flat-0_to_functor-0.length -unknown_txs-flat-0_length-0)
                         )
                         (ap "tracking txs for" $array-inline-72)
                        )
                        (ap -unknown_txs-flat-0_length-0 $array-inline-72)
                       )
                       (ap "deals" $array-inline-72)
                      )
                      (canon %init_peer_id% $array-inline-72  #array-inline-72-0)
                     )
                    )
                    (par
                     (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-72-0])
                     (null)
                    )
                   )
                   (call %init_peer_id% ("json" "stringify") [#array-inline-72-0] ret-230)
                  )
                  (call %init_peer_id% (-spell_id-arg- "store_log") [ret-230] ret-231)
                 )
                 (call %init_peer_id% ("chain_connector" "get_tx_statuses") [-chain-arg-.$.api_endpoint -unknown_txs-flat-0] ret-232)
                )
                (xor
                 (match ret-232.$.success true
                  (ap false not-18)
                 )
                 (ap true not-18)
                )
               )
               (new -if-else-error-
                (new -else-error-
                 (new -if-error-
                  (xor
                   (match not-18 true
                    (seq
                     (seq
                      (seq
                       (new $array-inline-73
                        (seq
                         (seq
                          (ap "couldn't make batch jsonrpc request:" $array-inline-73)
                          (ap ret-232.$.error $array-inline-73)
                         )
                         (canon %init_peer_id% $array-inline-73  #array-inline-73-0)
                        )
                       )
                       (par
                        (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-73-0])
                        (null)
                       )
                      )
                      (call %init_peer_id% ("json" "stringify") [#array-inline-73-0] ret-233)
                     )
                     (call %init_peer_id% (-spell_id-arg- "store_log") [ret-233] ret-234)
                    )
                   )
                   (seq
                    (ap :error: -if-error-)
                    (xor
                     (match :error:.$.error_code 10001
                      (fold ret-232.$.results status-1
                       (seq
                        (seq
                         (xor
                          (match status-1.$.success true
                           (ap false not-19)
                          )
                          (ap true not-19)
                         )
                         (new -if-else-error-
                          (new -else-error-
                           (new -if-error-
                            (xor
                             (match not-19 true
                              (seq
                               (seq
                                (seq
                                 (seq
                                  (seq
                                   (new $array-inline-74
                                    (seq
                                     (seq
                                      (seq
                                       (seq
                                        (seq
                                         (ap "couldn't find tx status:" $array-inline-74)
                                         (ap "tx_hash:" $array-inline-74)
                                        )
                                        (ap status-1.$.tx.tx_hash $array-inline-74)
                                       )
                                       (ap "error:" $array-inline-74)
                                      )
                                      (ap status-1.$.error $array-inline-74)
                                     )
                                     (canon %init_peer_id% $array-inline-74  #array-inline-74-0)
                                    )
                                   )
                                   (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" status-1.$.tx.deal_id ": "] ret-235)
                                  )
                                  (par
                                   (call %init_peer_id% ("run-console" "print") [ret-235 #array-inline-74-0])
                                   (null)
                                  )
                                 )
                                 (call %init_peer_id% ("json" "stringify") [#array-inline-74-0] ret-236)
                                )
                                (call %init_peer_id% ("op" "concat_strings") [ret-235 ret-236] ret-237)
                               )
                               (call %init_peer_id% (-spell_id-arg- "store_log") [ret-237] ret-238)
                              )
                             )
                             (seq
                              (ap :error: -if-error-)
                              (xor
                               (match :error:.$.error_code 10001
                                (new -if-error-
                                 (xor
                                  (mismatch status-1.$.status "pending"
                                   (seq
                                    (seq
                                     (seq
                                      (seq
                                       (seq
                                        (new %WorkerTxStatus_obj_map
                                         (seq
                                          (seq
                                           (ap ("status" status-1.$.status) %WorkerTxStatus_obj_map)
                                           (ap ("tx_info" status-1.$.tx) %WorkerTxStatus_obj_map)
                                          )
                                          (canon %init_peer_id% %WorkerTxStatus_obj_map  WorkerTxStatus_obj)
                                         )
                                        )
                                        (call %init_peer_id% ("json" "stringify") [WorkerTxStatus_obj] ret-239)
                                       )
                                       (call %init_peer_id% (-spell_id-arg- "list_push_string") ["worker_registration_txs_statuses" ret-239] ret-240)
                                      )
                                      (xor
                                       (match ret-240.$.success true
                                        (ap false not-20)
                                       )
                                       (ap true not-20)
                                      )
                                     )
                                     (new -if-error-
                                      (xor
                                       (match not-20 true
                                        (seq
                                         (seq
                                          (seq
                                           (new $array-inline-75
                                            (seq
                                             (seq
                                              (seq
                                               (seq
                                                (ap "can't store value in list by key" $array-inline-75)
                                                (ap "worker_registration_txs_statuses" $array-inline-75)
                                               )
                                               (ap "error:" $array-inline-75)
                                              )
                                              (ap ret-240.$.error $array-inline-75)
                                             )
                                             (canon %init_peer_id% $array-inline-75  #array-inline-75-0)
                                            )
                                           )
                                           (par
                                            (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-75-0])
                                            (null)
                                           )
                                          )
                                          (call %init_peer_id% ("json" "stringify") [#array-inline-75-0] ret-241)
                                         )
                                         (call %init_peer_id% (-spell_id-arg- "store_log") [ret-241] ret-242)
                                        )
                                       )
                                       (seq
                                        (ap :error: -if-error-)
                                        (xor
                                         (match :error:.$.error_code 10001
                                          (null)
                                         )
                                         (fail -if-error-)
                                        )
                                       )
                                      )
                                     )
                                    )
                                    (new -if-error-
                                     (xor
                                      (match status-1.$.status "failed"
                                       (seq
                                        (seq
                                         (seq
                                          (seq
                                           (seq
                                            (seq
                                             (seq
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (seq
                                                   (seq
                                                    (new $option-inline
                                                     (seq
                                                      (xor
                                                       (ap status-1.$.tx.tx_hash $option-inline)
                                                       (null)
                                                      )
                                                      (canon %init_peer_id% $option-inline  #option-inline-0)
                                                     )
                                                    )
                                                    (new %TxFailed_obj-0_map
                                                     (seq
                                                      (seq
                                                       (ap ("block_number" status-1.$.block_number) %TxFailed_obj-0_map)
                                                       (ap ("tx_hash" #option-inline-0) %TxFailed_obj-0_map)
                                                      )
                                                      (canon %init_peer_id% %TxFailed_obj-0_map  TxFailed_obj-0)
                                                     )
                                                    )
                                                   )
                                                   (new %FailedDealError_obj-1_map
                                                    (seq
                                                     (seq
                                                      (ap ("content" TxFailed_obj-0) %FailedDealError_obj-1_map)
                                                      (ap ("type" "TxFailed") %FailedDealError_obj-1_map)
                                                     )
                                                     (canon %init_peer_id% %FailedDealError_obj-1_map  FailedDealError_obj-1)
                                                    )
                                                   )
                                                  )
                                                  (new %FailedDeal_obj-1_map
                                                   (seq
                                                    (seq
                                                     (seq
                                                      (ap ("deal_id" status-1.$.tx.deal_id) %FailedDeal_obj-1_map)
                                                      (ap ("message" "transaction failed") %FailedDeal_obj-1_map)
                                                     )
                                                     (ap ("payload" FailedDealError_obj-1) %FailedDeal_obj-1_map)
                                                    )
                                                    (canon %init_peer_id% %FailedDeal_obj-1_map  FailedDeal_obj-1)
                                                   )
                                                  )
                                                 )
                                                 (call %init_peer_id% ("json" "stringify") [FailedDeal_obj-1] ret-243)
                                                )
                                                (call %init_peer_id% (-spell_id-arg- "list_push_string") ["failed_deals" ret-243] ret-244)
                                               )
                                               (xor
                                                (match ret-244.$.success true
                                                 (ap false not-21)
                                                )
                                                (ap true not-21)
                                               )
                                              )
                                              (new -if-error-
                                               (xor
                                                (match not-21 true
                                                 (seq
                                                  (seq
                                                   (seq
                                                    (new $array-inline-76
                                                     (seq
                                                      (seq
                                                       (seq
                                                        (seq
                                                         (ap "can't store value in list by key" $array-inline-76)
                                                         (ap "failed_deals" $array-inline-76)
                                                        )
                                                        (ap "error:" $array-inline-76)
                                                       )
                                                       (ap ret-244.$.error $array-inline-76)
                                                      )
                                                      (canon %init_peer_id% $array-inline-76  #array-inline-76-0)
                                                     )
                                                    )
                                                    (par
                                                     (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-76-0])
                                                     (null)
                                                    )
                                                   )
                                                   (call %init_peer_id% ("json" "stringify") [#array-inline-76-0] ret-245)
                                                  )
                                                  (call %init_peer_id% (-spell_id-arg- "store_log") [ret-245] ret-246)
                                                 )
                                                )
                                                (seq
                                                 (ap :error: -if-error-)
                                                 (xor
                                                  (match :error:.$.error_code 10001
                                                   (null)
                                                  )
                                                  (fail -if-error-)
                                                 )
                                                )
                                               )
                                              )
                                             )
                                             (new $array-inline-77
                                              (seq
                                               (seq
                                                (seq
                                                 (seq
                                                  (ap "transaction failed, tx_hash:" $array-inline-77)
                                                  (ap status-1.$.tx.tx_hash $array-inline-77)
                                                 )
                                                 (ap "block_number:" $array-inline-77)
                                                )
                                                (ap status-1.$.block_number $array-inline-77)
                                               )
                                               (canon %init_peer_id% $array-inline-77  #array-inline-77-0)
                                              )
                                             )
                                            )
                                            (call %init_peer_id% ("op" "concat_strings") ["decider deal_id=" status-1.$.tx.deal_id ": "] ret-247)
                                           )
                                           (par
                                            (call %init_peer_id% ("run-console" "print") [ret-247 #array-inline-77-0])
                                            (null)
                                           )
                                          )
                                          (call %init_peer_id% ("json" "stringify") [#array-inline-77-0] ret-248)
                                         )
                                         (call %init_peer_id% ("op" "concat_strings") [ret-247 ret-248] ret-249)
                                        )
                                        (call %init_peer_id% (-spell_id-arg- "store_log") [ret-249] ret-250)
                                       )
                                      )
                                      (seq
                                       (ap :error: -if-error-)
                                       (xor
                                        (match :error:.$.error_code 10001
                                         (null)
                                        )
                                        (fail -if-error-)
                                       )
                                      )
                                     )
                                    )
                                   )
                                  )
                                  (seq
                                   (ap :error: -if-error-)
                                   (xor
                                    (match :error:.$.error_code 10002
                                     (null)
                                    )
                                    (fail -if-error-)
                                   )
                                  )
                                 )
                                )
                               )
                               (seq
                                (seq
                                 (ap :error: -else-error-)
                                 (xor
                                  (match :error:.$.error_code 10001
                                   (ap -if-error- -if-else-error-)
                                  )
                                  (ap -else-error- -if-else-error-)
                                 )
                                )
                                (fail -if-else-error-)
                               )
                              )
                             )
                            )
                           )
                          )
                         )
                        )
                        (next status-1)
                       )
                       (null)
                      )
                     )
                     (seq
                      (seq
                       (ap :error: -else-error-)
                       (xor
                        (match :error:.$.error_code 10001
                         (ap -if-error- -if-else-error-)
                        )
                        (ap -else-error- -if-else-error-)
                       )
                      )
                      (fail -if-else-error-)
                     )
                    )
                   )
                  )
                 )
                )
               )
              )
             )
             (seq
              (ap :error: -if-error-)
              (xor
               (match :error:.$.error_code 10002
                (null)
               )
               (fail -if-error-)
              )
             )
            )
           )
          )
          (null)
         )
        )
        (xor
         (seq
          (new $result-14
           (seq
            (seq
             (seq
              (seq
               (call %init_peer_id% (-spell_id-arg- "get_string") ["last_seen_block"] ret-251)
               (xor
                (match ret-251.$.success true
                 (ap false not-22)
                )
                (ap true not-22)
               )
              )
              (new -if-else-error-
               (new -else-error-
                (new -if-error-
                 (xor
                  (match not-22 true
                   (seq
                    (seq
                     (seq
                      (new $array-inline-78
                       (seq
                        (seq
                         (seq
                          (ap "get_string failed" $array-inline-78)
                          (ap "last_seen_block" $array-inline-78)
                         )
                         (ap ret-251.$.error $array-inline-78)
                        )
                        (canon %init_peer_id% $array-inline-78  #array-inline-78-0)
                       )
                      )
                      (par
                       (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-78-0])
                       (null)
                      )
                     )
                     (call %init_peer_id% ("json" "stringify") [#array-inline-78-0] ret-252)
                    )
                    (call %init_peer_id% (-spell_id-arg- "store_log") [ret-252] ret-253)
                   )
                  )
                  (seq
                   (ap :error: -if-error-)
                   (xor
                    (match :error:.$.error_code 10001
                     (seq
                      (xor
                       (match ret-251.$.absent true
                        (ap false not-23)
                       )
                       (ap true not-23)
                      )
                      (new -if-error-
                       (xor
                        (match not-23 true
                         (ap ret-251.$.str $result-14)
                        )
                        (seq
                         (ap :error: -if-error-)
                         (xor
                          (match :error:.$.error_code 10001
                           (null)
                          )
                          (fail -if-error-)
                         )
                        )
                       )
                      )
                     )
                    )
                    (seq
                     (seq
                      (ap :error: -else-error-)
                      (xor
                       (match :error:.$.error_code 10001
                        (ap -if-error- -if-else-error-)
                       )
                       (ap -else-error- -if-else-error-)
                      )
                     )
                     (fail -if-else-error-)
                    )
                   )
                  )
                 )
                )
               )
              )
             )
             (canon %init_peer_id% $result-14  #-result-fix-0-5)
            )
            (ap #-result-fix-0-5 -result-flat-0-5)
           )
          )
          (new -if-error-
           (xor
            (mismatch -result-flat-0-5 []
             (seq
              (seq
               (seq
                (seq
                 (seq
                  (seq
                   (call %init_peer_id% ("chain_connector" "hex_diff") [-result-flat-0-5.$.[0] -latest-flat-0.$.[0]] ret-254)
                   (new $result-15
                    (seq
                     (seq
                      (call %init_peer_id% (-spell_id-arg- "get_u32") ["counter"] ret-255)
                      (new -if-else-error-
                       (new -else-error-
                        (new -if-error-
                         (xor
                          (match ret-255.$.success true
                           (ap ret-255.$.num $result-15)
                          )
                          (seq
                           (ap :error: -if-error-)
                           (xor
                            (match :error:.$.error_code 10001
                             (ap 0 $result-15)
                            )
                            (seq
                             (seq
                              (ap :error: -else-error-)
                              (xor
                               (match :error:.$.error_code 10001
                                (ap -if-error- -if-else-error-)
                               )
                               (ap -else-error- -if-else-error-)
                              )
                             )
                             (fail -if-else-error-)
                            )
                           )
                          )
                         )
                        )
                       )
                      )
                     )
                     (new $result-15_test
                      (seq
                       (seq
                        (fold $result-15 result-15_fold_var
                         (seq
                          (seq
                           (ap result-15_fold_var $result-15_test)
                           (canon %init_peer_id% $result-15_test  #result-15_iter_canon)
                          )
                          (xor
                           (match #result-15_iter_canon.length 1
                            (null)
                           )
                           (next result-15_fold_var)
                          )
                         )
                         (never)
                        )
                        (canon %init_peer_id% $result-15_test  #result-15_result_canon)
                       )
                       (ap #result-15_result_canon result-15_gate)
                      )
                     )
                    )
                   )
                  )
                  (new %SyncInfo_obj_map
                   (seq
                    (seq
                     (ap ("blocks_diff" ret-254) %SyncInfo_obj_map)
                     (ap ("run_updated" result-15_gate.$.[0]) %SyncInfo_obj_map)
                    )
                    (canon %init_peer_id% %SyncInfo_obj_map  SyncInfo_obj)
                   )
                  )
                 )
                 (call %init_peer_id% ("json" "stringify") [SyncInfo_obj] ret-256)
                )
                (call %init_peer_id% (-spell_id-arg- "set_string") ["sync_info" ret-256] ret-257)
               )
               (xor
                (match ret-257.$.success true
                 (ap false not-24)
                )
                (ap true not-24)
               )
              )
              (new -if-error-
               (xor
                (match not-24 true
                 (seq
                  (seq
                   (seq
                    (new $array-inline-79
                     (seq
                      (seq
                       (seq
                        (seq
                         (ap "can't updated sync state" $array-inline-79)
                         (ap SyncInfo_obj $array-inline-79)
                        )
                        (ap "error" $array-inline-79)
                       )
                       (ap ret-257.$.error $array-inline-79)
                      )
                      (canon %init_peer_id% $array-inline-79  #array-inline-79-0)
                     )
                    )
                    (par
                     (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-79-0])
                     (null)
                    )
                   )
                   (call %init_peer_id% ("json" "stringify") [#array-inline-79-0] ret-258)
                  )
                  (call %init_peer_id% (-spell_id-arg- "store_log") [ret-258] ret-259)
                 )
                )
                (seq
                 (ap :error: -if-error-)
                 (xor
                  (match :error:.$.error_code 10001
                   (null)
                  )
                  (fail -if-error-)
                 )
                )
               )
              )
             )
            )
            (seq
             (ap :error: -if-error-)
             (xor
              (match :error:.$.error_code 10002
               (null)
              )
              (fail -if-error-)
             )
            )
           )
          )
         )
         (null)
        )
       )
       (xor
        (seq
         (seq
          (seq
           (seq
            (seq
             (call %init_peer_id% (-spell_id-arg- "get_mailbox") [] ret-260)
             (new $array-inline-80
              (seq
               (seq
                (ap "mailbox" $array-inline-80)
                (ap ret-260 $array-inline-80)
               )
               (canon %init_peer_id% $array-inline-80  #array-inline-80-0)
              )
             )
            )
            (par
             (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-80-0])
             (null)
            )
           )
           (call %init_peer_id% ("json" "stringify") [#array-inline-80-0] ret-261)
          )
          (call %init_peer_id% (-spell_id-arg- "store_log") [ret-261] ret-262)
         )
         (new -if-error-
          (xor
           (match ret-260.$.success true
            (fold ret-260.$.messages msg-159-0
             (seq
              (xor
               (seq
                (seq
                 (seq
                  (seq
                   (seq
                    (seq
                     (seq
                      (seq
                       (seq
                        (seq
                         (seq
                          (call %init_peer_id% ("json" "parse") [msg-159-0.$.message] ret-263)
                          (new -if-error-
                           (xor
                            (mismatch ret-263.$.remove []
                             (seq
                              (seq
                               (seq
                                (seq
                                 (seq
                                  (ap ret-263.$.remove ret-263_flat)
                                  (new $array-inline-81
                                   (seq
                                    (seq
                                     (seq
                                      (seq
                                       (ap "will remove worker" $array-inline-81)
                                       (ap ret-263_flat.$.[0].worker_id $array-inline-81)
                                      )
                                      (ap "from host" $array-inline-81)
                                     )
                                     (ap ret-263_flat.$.[0].host_id $array-inline-81)
                                    )
                                    (canon %init_peer_id% $array-inline-81  #array-inline-81-0)
                                   )
                                  )
                                 )
                                 (par
                                  (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-81-0])
                                  (null)
                                 )
                                )
                                (call %init_peer_id% ("json" "stringify") [#array-inline-81-0] ret-264)
                               )
                               (call %init_peer_id% ("spell" "store_log") [ret-264] ret-265)
                              )
                              (xor
                               (seq
                                (seq
                                 (new $-ephemeral-stream-
                                  (new #-ephemeral-canon-
                                   (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                  )
                                 )
                                 (call ret-263_flat.$.[0].host_id ("worker" "remove") [ret-263_flat.$.[0].worker_id])
                                )
                                (new $-ephemeral-stream-
                                 (new #-ephemeral-canon-
                                  (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                 )
                                )
                               )
                               (seq
                                (seq
                                 (new $-ephemeral-stream-
                                  (new #-ephemeral-canon-
                                   (canon -relay- $-ephemeral-stream-  #-ephemeral-canon-)
                                  )
                                 )
                                 (new $-ephemeral-stream-
                                  (new #-ephemeral-canon-
                                   (canon %init_peer_id% $-ephemeral-stream-  #-ephemeral-canon-)
                                  )
                                 )
                                )
                                (fail :error:)
                               )
                              )
                             )
                            )
                            (seq
                             (ap :error: -if-error-)
                             (xor
                              (match :error:.$.error_code 10002
                               (null)
                              )
                              (fail -if-error-)
                             )
                            )
                           )
                          )
                         )
                         (par
                          (call %init_peer_id% ("run-console" "print") ["decider" "will pop"])
                          (null)
                         )
                        )
                        (call %init_peer_id% ("json" "stringify") ["will pop"] ret-266)
                       )
                       (call %init_peer_id% (-spell_id-arg- "store_log") [ret-266] ret-267)
                      )
                      (call %init_peer_id% (-spell_id-arg- "pop_mailbox") [] ret-268)
                     )
                     (ap ret-268.$.message ret-268_flat)
                    )
                    (ap ret-268_flat ret-268_flat_to_functor)
                   )
                   (ap ret-268_flat_to_functor.length ret-268_flat_length)
                  )
                  (xor
                   (match ret-268_flat_length 0
                    (ap true eq)
                   )
                   (ap false eq)
                  )
                 )
                 (xor
                  (match eq true
                   (ap eq or)
                  )
                  (seq
                   (xor
                    (mismatch ret-268.$.message.[0].message msg-159-0.$.message
                     (ap true neq)
                    )
                    (ap false neq)
                   )
                   (ap neq or)
                  )
                 )
                )
                (new -if-error-
                 (xor
                  (match or true
                   (seq
                    (seq
                     (seq
                      (new $array-inline-82
                       (seq
                        (seq
                         (seq
                          (seq
                           (ap "произошла чудовищная ошибка. expected" $array-inline-82)
                           (ap msg-159-0 $array-inline-82)
                          )
                          (ap "popped" $array-inline-82)
                         )
                         (ap ret-268 $array-inline-82)
                        )
                        (canon %init_peer_id% $array-inline-82  #array-inline-82-0)
                       )
                      )
                      (par
                       (call %init_peer_id% ("run-console" "print") ["decider" #array-inline-82-0])
                       (null)
                      )
                     )
                     (call %init_peer_id% ("json" "stringify") [#array-inline-82-0] ret-269)
                    )
                    (call %init_peer_id% (-spell_id-arg- "store_log") [ret-269] ret-270)
                   )
                  )
                  (seq
                   (ap :error: -if-error-)
                   (xor
                    (match :error:.$.error_code 10001
                     (null)
                    )
                    (fail -if-error-)
                   )
                  )
                 )
                )
               )
               (null)
              )
              (next msg-159-0)
             )
             (null)
            )
           )
           (seq
            (ap :error: -if-error-)
            (xor
             (match :error:.$.error_code 10001
              (null)
             )
             (fail -if-error-)
            )
           )
          )
         )
        )
        (null)
       )
      )
     )
     (seq
      (ap :error: -if-error-)
      (xor
       (match :error:.$.error_code 10002
        (null)
       )
       (fail -if-error-)
      )
     )
    )
   )
  )
  (call %init_peer_id% ("callbackSrv" "response") [])
 )
 (call %init_peer_id% ("errorHandlingSrv" "error") [:error: 0])
)
